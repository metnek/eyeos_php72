function loadCode(){window.parent.sendMsg($checknum,"openFile","")}function getMyFile(){window.parent.sendMsg($checknum,"getFile","")}function save_ed(e){window.parent.sendMsg($checknum,"Save","<arg1>ed</arg1>"),alert(e)}var Slimey;Slimey=function(e){e.rootDir&&(Slimey.rootDir=e.rootDir),e.imagesDir&&(Slimey.imagesDir=e.imagesDir),e.filename&&(this.filename=e.filename),e.slimContent&&(this.slimContent=e.slimContent),e.saveUrl&&(this.saveUrl=e.saveUrl),this.config=e,Slimey.preloadImages(),this.editor=new SlimeyEditor(this),this.navigation=new SlimeyNavigation(this),this.Navbar=new SlimeyNavbar(this);var t=document.createElement("div");t.style.position="absolute",t.style.marginTop="0px",t.style.marginLeft="0px",t.style.marginRight="0px",t.style.height="58px",t.style.width="100%",t.appendChild(this.Navbar.container),this.edtoolbar=new SlimeyToolbar(this,[new SlimeySaveTool(this),"-",new SlimeyInsertTextTool(this),new SlimeyInsertOrderedListTool(this),new SlimeyInsertUnorderedListTool(this),new SlimeyDeleteTool(this),"-",new SlimeyUndoTool(this),new SlimeyRedoTool(this),"-",new SlimeyFontColorTool(this),new SlimeyFontFamilyTool(this),new SlimeyFontSizeTool(this),"-",new SlimeyStyleToggleTool(this,"bold",lang("bold text"),"fontWeight","bold","normal"),new SlimeyStyleToggleTool(this,"underline",lang("underline text"),"textDecoration","underline","none"),new SlimeyStyleToggleTool(this,"italic",lang("italic text"),"fontStyle","italic","normal"),"-",new SlimeySendToBackTool(this),new SlimeyBringToFrontTool(this),"-",new SlimeyViewSourceTool(this),new SlimeyPreviewTool(this)]),this.navtoolbar=new SlimeyToolbar(this,[new SlimeyAddSlideTool(this),new SlimeyDeleteSlideTool(this),"-",new SlimeyMoveSlideDownTool(this),new SlimeyMoveSlideUpTool(this)]),typeof e.container=="string"?this.container=document.getElementById(e.container):typeof e.container=="object"?this.container=e.container:this.container=document.body,this.container.appendChild(t),this.container.appendChild(this.navtoolbar.container),this.container.appendChild(this.edtoolbar.container),this.container.appendChild(this.navigation.container),this.container.appendChild(this.editor.container);var n=this.aspect||4/3,r=this.container.offsetHeight,i=this.container.offsetWidth;this.navtoolbar.container.style.position="absolute",this.navtoolbar.container.style.width=this.navigation.container.offsetWidth+"px",this.navtoolbar.container.style.top="60px",this.navigation.container.style.position="absolute",this.navigation.container.style.top=this.navtoolbar.container.offsetHeight+60+"px",this.navigation.container.style.height=r-this.navtoolbar.container.offsetHeight+"px",this.edtoolbar.container.style.position="absolute",this.edtoolbar.container.style.left=this.navigation.container.offsetWidth+"px",this.edtoolbar.container.style.width=i-this.navigation.container.offsetWidth+"px",this.edtoolbar.container.style.top="60px",this.editor.container.style.position="absolute",this.editor.container.style.top="95px",this.editor.container.style.left="210px";var s,o;self.innerHeight?(s=self.innerWidth,o=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(s=document.documentElement.clientWidth,o=document.documentElement.clientHeight):document.body&&(s=document.body.clientWidth,o=document.body.clientHeight);var u=s-200,a=o-120;u>a*n?(this.editor.container.style.height=a+"px",this.editor.container.style.width=a*n+"px",this.editor.container.style.left=this.navigation.container.offsetWidth+(i-this.navigation.container.offsetWidth-a*n)/2+"px",this.editor.container.style.top=this.edtoolbar.container.offsetHeight+60):(this.editor.container.style.height=u/n+"px",this.editor.container.style.width=u+"px",this.editor.container.style.left=this.navigation.container.offsetWidth+0+"px",this.editor.container.style.top=this.edtoolbar.container.offsetHeight+60),addEventHandler(window,"resize",this.layout,this)},Slimey.prototype.layout=function(){var e,t,n,r,i=this.aspect||4/3,s=this.container.offsetHeight,o=this.container.offsetWidth;this.navtoolbar.container.style.position="absolute",this.navtoolbar.container.style.width=this.navigation.container.offsetWidth+"px",this.navtoolbar.container.style.top="60px",this.navigation.container.style.position="absolute",this.navigation.container.style.top=this.navtoolbar.container.offsetHeight+60+"px",this.navigation.container.style.height=s-this.navtoolbar.container.offsetHeight+"px",this.edtoolbar.container.style.position="absolute",this.edtoolbar.container.style.left=this.navigation.container.offsetWidth+"px",this.edtoolbar.container.style.width=o-this.navigation.container.offsetWidth+"px",this.edtoolbar.container.style.top="60px",this.editor.container.style.position="absolute",this.editor.container.style.top="95px",this.editor.container.style.left="210px",self.innerHeight?(e=self.innerWidth,t=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(e=document.documentElement.clientWidth,t=document.documentElement.clientHeight):document.body&&(e=document.body.clientWidth,t=document.body.clientHeight),n=e-200,r=t-120,n>r*i?(this.editor.container.style.height=r+"px",this.editor.container.style.width=r*i+"px",this.editor.container.style.left=this.navigation.container.offsetWidth+(o-this.navigation.container.offsetWidth-r*i)/2+"px",this.editor.container.style.top=this.edtoolbar.container.offsetHeight+60):(this.editor.container.style.height=n/i+"px",this.editor.container.style.width=n+"px",this.editor.container.style.left=this.navigation.container.offsetWidth+0+"px",this.editor.container.style.top=this.edtoolbar.container.offsetHeight+60),this.editor.resized()},Slimey.prototype.submitFile=function(){sc.value=this.slimContent,window.parent.sendMsg($checknum,"saveFile",sc.value)},Slimey.imagesDir="index.php?theme="+USERTHEME+"&extern=icons/22x22/eyeShow/",Slimey.preloadedImages=[],Slimey.includeScripts=function(){Slimey.rootDir="index.php?extern=apps/eyeShow/getjs.eyecode&type=dynamic&type=dynamic&params[]=$myPid&params[]=$checknum&params[]=",document.write('<script language="javascript" src="'+Slimey.rootDir+'functions"></script>'),document.write('<script language="javascript" src="'+Slimey.rootDir+'stack"></script>'),document.write('<script language="javascript" src="'+Slimey.rootDir+'editor"></script>'),document.write('<script language="javascript" src="'+Slimey.rootDir+'navigation"></script>'),document.write('<script language="javascript" src="'+Slimey.rootDir+'actions"></script>'),document.write('<script language="javascript" src="'+Slimey.rootDir+'tools"></script>'),document.write('<script language="javascript" src="'+Slimey.rootDir+'toolbar"></script>')},Slimey.preloadImage=function(e){var t=Slimey.preloadedImages,n=t.length;t[n]=new Image,t[n].src=Slimey.imagesDir+e},Slimey.preloadToolbarImage=function(e){Slimey.preloadImage(e+".png"),Slimey.preloadImage(e+"h.png"),Slimey.preloadImage(e+"x.png"),Slimey.preloadImage(e+"d.png")},Slimey.preloadImages=function(){if(!Image)return;Slimey.preloadToolbarImage("bold"),Slimey.preloadToolbarImage("bringToFront"),Slimey.preloadToolbarImage("color"),Slimey.preloadToolbarImage("delete"),Slimey.preloadToolbarImage("empty"),Slimey.preloadToolbarImage("insertImage"),Slimey.preloadToolbarImage("insertOList"),Slimey.preloadToolbarImage("insertUList"),Slimey.preloadToolbarImage("insertText"),Slimey.preloadToolbarImage("italic"),Slimey.preloadToolbarImage("preview"),Slimey.preloadToolbarImage("redo"),Slimey.preloadToolbarImage("save"),Slimey.preloadToolbarImage("sendToBack"),Slimey.preloadToolbarImage("underline"),Slimey.preloadToolbarImage("undo"),Slimey.preloadToolbarImage("viewSource"),Slimey.preloadImage("newslide.png"),Slimey.preloadImage("delslide.png"),Slimey.preloadImage("sep.png")},Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,r,i,s,o,u,a="",f=0;e=Base64._utf8_encode(e);while(f<e.length)t=e.charCodeAt(f++),n=e.charCodeAt(f++),r=e.charCodeAt(f++),i=t>>2,s=(t&3)<<4|n>>4,o=(n&15)<<2|r>>6,u=r&63,isNaN(n)?o=u=64:isNaN(r)&&(u=64),a=a+this._keyStr.charAt(i)+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u);return a},decode:function(e){var t,n,r,i,s,o,u,a="",f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length)i=this._keyStr.indexOf(e.charAt(f++)),s=this._keyStr.indexOf(e.charAt(f++)),o=this._keyStr.indexOf(e.charAt(f++)),u=this._keyStr.indexOf(e.charAt(f++)),t=i<<2|s>>4,n=(s&15)<<4|o>>2,r=(o&3)<<6|u,a+=String.fromCharCode(t),o!=64&&(a+=String.fromCharCode(n)),u!=64&&(a+=String.fromCharCode(r));return a=Base64._utf8_decode(a),a},_utf8_encode:function(e){var t,n,r;e=e.replace(/\r\n/g,"\n"),t="";for(n=0;n<e.length;n++)r=e.charCodeAt(n),r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128));return t},_utf8_decode:function(e){var t="",n=0,r=c1=c2=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|c2&63),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63),n+=3);return t}};