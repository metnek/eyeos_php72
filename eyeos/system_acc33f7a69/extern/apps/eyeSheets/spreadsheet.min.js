function trans(e){return strings[e]?strings[e]:"["+e+"]"}function keypress(e){var e,t,n,r,i,s;return!getObj("value")||active=="code"?!0:(e=e?e:window.event,t=getmykey(e),n=!0,active=="position"?(t==13&&(gotoCell(getObj("field").value),active="content",n=!1),n):active=="dimensions"?(t==13&&(rows=parseInt(getObj("rows").value),cols=parseInt(getObj("cols").value),active="content",display(),n=!1),n):(getObj("styling").disabled?(getObj("focus").focus(),active="content",r=e.shiftKey,i=e.altKey,s=e.ctrlKey,s&&(t==88||t==120)||r&&t==46?(cutcopy("cut","#FFDDDD"),n=!1):s&&(t==67||t==99)||s&&t==45?(cutcopy("copy","#DDDDFF"),n=!1):(s&&(t==86||t==118)||r&&t==45)&&clipboard_mode!=""&&(paste(),n=!1),r&&!isShiftDown?(highlightRange(multiRange,"cell"),multiRange=[currRow,currCol,currRow,currCol],isShiftDown=1):!i&&!s&&!r&&multiRange.length>0&&t!=46&&(highlightRange(multiRange,"cell"),multiRange=[],isShiftDown=0,isMouseDown=0),!i&&!s&&t!=0&&(t==33?(currRow-10<=row0&&currRow>10?(row0-=rows,display(),mouseoverCell(currRow-10,currCol),scrollDown()):(mouseoverCell(currRow<10?0:currRow-10,currCol),scrollUp()),n=!1):t==34?(currRow+10<row0+rows?(mouseoverCell(currRow+10,currCol),scrollDown()):(row0+=rows,display(),mouseoverCell(currRow+10,currCol),scrollUp()),n=!1):t==36?(currCol!=col0?mouseoverCell(currRow,col0):currCol+1<cols?currRow>row0?mouseoverCell(row0,currCol):currRow+1>rows&&(row0-=rows,display(),mouseoverCell(currRow-rows,currCol)):(col0-=cols,display(),mouseoverCell(currRow,currCol-cols)),scrollLeft(),n=!1):t==35?(currCol!=col0+cols-1?mouseoverCell(currRow,col0+cols-1):(col0+=cols,display(),mouseoverCell(currRow,currCol+cols)),scrollRight(),n=!1):t==39||t==9?(goRight(),n=!1):t==40?(goDown(),n=!1):t==38&&currRow>-2?(goUp(),n=!1):t==37&&currCol>-1?(goLeft(),n=!1):!r&&t==46&&isWriteable&&confirm(trans("Really empty cell(s) ?"))?(removeSelectedCell(),n=!1):(t<33||t>40)&&t!=46&&t!=45&&t!=16&&t!=17&&t!=18&&(editCell(currRow,currCol,t),t==13&&(n=!1))),isShiftDown&&(highlightRange(multiRange,"cell"),multiRange[2]=currRow,multiRange[3]=currCol,highlightRange(multiRange,"cell_highlight_over"))):t==13?(saveCell(),n=!1):t==27&&(cancelCell(),n=!1),n))}function goLeft(){currCol<=col0&&currCol>0?(col0-=cols,display(),mouseoverCell(currRow,currCol-1),scrollRight()):(mouseoverCell(currRow,currCol-1),scrollLeft())}function goUp(){currRow<=row0&&currRow>0?(row0-=rows,display(),mouseoverCell(currRow-1,currCol),scrollDown()):(mouseoverCell(currRow-1,currCol),scrollUp())}function goRight(){currCol+1<col0+cols?(mouseoverCell(currRow,currCol+1),scrollRight()):(col0+=cols,display(),mouseoverCell(currRow,currCol+1),scrollLeft())}function goDown(){currRow+1<row0+rows?(mouseoverCell(currRow+1,currCol),scrollDown()):(row0+=rows,display(),mouseoverCell(currRow+1,currCol),scrollUp())}function display(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g;marks=[],isMouseDown=0,e=0,t=0,getObj("content")&&(e=getObj("content").scrollLeft,t=getObj("content").scrollTop),n="",isWriteable&&(n+='<div class="blockbar">',n+='<div class="blockbarItem" onclick="load(init_data); resetPath();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/filenew.png" /><div class="blockbarText">'+trans("New")+"</div></div>",n+='<div class="blockbarItem" onclick="loadCode();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/fileopen.png" /><div class="blockbarText">'+trans("Open")+"</div></div>",n+='<div class="blockbarItem" onclick="saveCode();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/filesave.png" /><div class="blockbarText">'+trans("Save")+"</div></div>",n+='<div class="blockbarItem" onclick="saveAs();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/filesaveas.png" /><div class="blockbarText">'+trans("Save As")+"</div></div>",n+='<span class="blockbarline" /></span>',n+='<div class="blockbarItem" onclick="insertRow();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/newrow.png" /><div class="blockbarText">'+trans("Ins. Row")+"</div></div>",n+='<div class="blockbarItem" onclick="insertColumn();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/newcolumn.png" /><div class="blockbarText">'+trans("Ins. Column")+"</div></div>",n+='<div class="blockbarItem" onclick="deleteRow();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/deleterow.png" /><div class="blockbarText">'+trans("Del. Row")+"</div></div>",n+='<div class="blockbarItem" onclick="deleteColumn();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/deletecolumn.png" /><div class="blockbarText">'+trans("Del. Column")+"</div></div>",n+='<span class="blockbarline" /></span>',n+='<div class="blockbarItem" onclick="print();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/agt_print.png" /><div class="blockbarText">'+trans("Print")+"</div></div>",n+='<div class="blockbarItem_right" onclick="help();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/help.png" /><div class="blockbarText">'+trans("Help")+"</div></div>",n+='<div class="blockbarItem_right" onclick="fullScreen();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/fullScreen.png" /><div class="blockbarText">'+trans("Full Screen")+"</div></div>",n+="</div>"),n+="<textarea id='focus' onfocus='this.blur();'></textarea><div id='header' class='header'><table cellpadding='0' cellspacing='0' style='width:100%;'><tr><td nowrap>",n+="<input type='text' value='' title='"+trans("Position")+"' id='field' style='width:30px; text-align:center;' onfocus='active=\"position\";' onblur='active=\"content\";' accesskey='g'> &nbsp;",n+="</td><td nowrap style='width:100%;'>",n+="<iframe src='about:blank' id='multiline'></iframe>",n+="<input type='text' value='' title='"+trans("Formula")+"' id='value' style='width:100%;' disabled onmouseover='previewValue();' onkeyup='previewValue();'> ",n+="<input type='hidden' title='"+trans("Style")+"' value='' id='styling' disabled onmouseover='previewValue();' onkeyup='previewValue();'> ",n+="</td><td nowrap>",isWriteable&&(n+="&nbsp; <input type='button' value='"+trans("Save")+"' id='save' onclick='saveCell();' disabled>&nbsp;",n+="<input type='button' value='"+trans("X")+"' id='cancel' onclick='cancelCell();' disabled>"),n+="</td></tr></table></div>",r="",agent=="msie"&&(r="style='height:expression((document.body.clientHeight-40)+\"px\");'"),n+="<div id='content' "+r+"><table id='table' cellspacing='0'>",n+="<tr>";if(showColumnGroups){n+="<th id='-2_-1' ondblclick='editCell(-2,-1);' onclick='mouseoverCell(-2,-1);'>"+htmlEscape(showCell(-2,-1,0),!0)+"</th>";for(i=col0;i<cols+col0;i++){s=showCell(-2,i,0);if(s&&(!marks[-2]||!marks[-2][i])){o=getCellStyle(-2,i,"colspan");if(o){marks[-2]||(marks[-2]=[]);for(u=i+1;u<i+o;u++)marks[-2][u]=[-2,i]}n+="<th id='-2_"+i+"' ondblclick='editCell(-2,"+i+",0);' onclick='mouseoverCell(-2,"+i+");' colspan='"+o+"'><div style='"+htmlEscape(formatStyle(getCells(-2,i,1),"_"),!1)+"'>"+htmlEscape(s,!0)+"</div></th>"}else if(!marks[-2]||!marks[-2][i])n+="<th id='-2_"+i+"' ondblclick='editCell(-2,"+i+",0);' onclick='mouseoverCell(-2,"+i+");'>&nbsp;</th>"}}n+="</tr>",n+="<tr><th id='-1_-1' ondblclick='editCell(-1,-1,0);' onclick='mouseoverCell(-1,-1);'>"+htmlEscape(showCell(-1,-1,0),!0)+"</th>";for(i=col0;i<cols+col0;i++)a=showCell(-1,i,0),n+="<th id='-1_"+i+"' ondblclick='editCell(-1,"+i+",0);' onclick='mouseoverCell(-1,"+i+");'><div style='"+htmlEscape(formatStyle(getCells(-1,i,1),"_"),!1)+"'>"+(a?htmlEscape(a,!0)+" - ":"")+buildColName(i)+"</div></th>";n+="</tr>",f=-1,l=!1;for(c=row0;c<rows+row0;c++){n+="<tr>",h=showCell(c,-1,0),n+="<th id='"+c+"_-1' ondblclick='editCell("+c+",-1,0);' onclick='mouseoverCell("+c+",-1);'><div style='"+htmlEscape(formatStyle(getCells(c,-1,1),"_"),!1)+"'>"+(h?htmlEscape(h,!0)+"<br>":"")+(c+1)+"</div></th>";for(p=col0;p<cols+col0;p++)if(view=="values"){if(!marks[c]||!marks[c][p]){r=getCells(c,p,1),d=showCell(c,p,0),o=getCellStyle(c,p,"colspan");if(o){marks[c]||(marks[c]=[]);for(u=p+1;u<p+o;u++)marks[c][u]=[c,p]}v=getCellStyle(c,p,"rowspan");if(v)for(u=c+1;u<c+v;u++)marks[u]||(marks[u]=[]),marks[u][p]=[c,p];d=formatValue(d,r),r=htmlEscape(formatStyle(r,d),!1),n+="<td "+(v?"rowspan='"+v+"'":"")+" "+(o?"colspan='"+o+"'":"")+" id='"+c+"_"+p+"' onmousedown='mousedown("+c+","+p+");' onmouseup='mouseup();' onmouseover='buildStatus("+c+","+p+");' onclick='mouseoverCell("+c+","+p+");' onclick='mouseoverCell("+c+","+p+");' ondblclick='editCell("+c+","+p+",0);'><div style='"+r+"'>"+htmlEscape(d,!0)+"</div></td>"}}else view=="formulas"?n+="<td id='"+c+"_"+p+"' onmouseover='buildStatus("+c+","+p+");' onclick='mouseoverCell("+c+","+p+");' onclick='mouseoverCell("+c+","+p+");' ondblclick='editCell("+c+","+p+",0);'>"+htmlEscape(getCells(c,p,0),!0)+"</td>":n+="<td id='"+c+"_"+p+"' onmouseover='buildStatus("+c+","+p+");' onclick='mouseoverCell("+c+","+p+");' onclick='mouseoverCell("+c+","+p+");' ondblclick='editCell("+c+","+p+",0);'>"+htmlEscape(getCells(c,p,1),!0)+"</td>";n+="</tr>"}n+="<tr id='spacer'><th class='empty'></th>";for(i=col0;i<cols+col0;i++)n+="<th class='empty'><img src='' style='width:"+col_min_width+"; height:0px;'></th>";n+="</tr>",n+="</table></div>",n+="<div class='footer' id='footer' onmouseover='getObj(\"status\").innerHTML=\"\";'>&nbsp;",allowPaging&&(col0-cols<0?n+="<img border='0' src='index.php?theme="+USERTHEME+"&extern=icons/16x16/back.png'> ":n+="<a href='#' onclick='col0 -= cols; currCol -= cols; display(); return false;'><img border='0' src='index.php?theme="+USERTHEME+"&extern=icons/16x16/back.png'></a> ",n+="<a href='#' onclick='col0 += cols; currCol += cols; display(); return false;'><img border='0' src='index.php?theme="+USERTHEME+"&extern=icons/16x16/forward.png'></a> ",row0-rows<0?n+=" <img border='0' src='index.php?theme="+USERTHEME+"&extern=icons/16x16/restore.png'> ":n+="<a href='#' onclick='row0 -= rows; currRow -= rows; display(); return false;'><img border='0' src='index.php?theme="+USERTHEME+"&extern=icons/16x16/restore.png'></a> ",n+="<a href='#' onclick='row0 += rows; currRow += rows; display(); return false;'><img border='0' src='index.php?theme="+USERTHEME+"&extern=icons/16x16/download.png'></a> "),n+="</div>",n+="<div class='statusText'> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "+trans("Sheet Size")+": <input type='text' value='"+cols+"' style='width:28px; text-align:center;' id='cols' onfocus='active=\"dimensions\";' onblur='active=\"content\";'> x <input type='text' value='"+rows+"' style='width:28px; text-align:center;' id='rows' onfocus='active=\"dimensions\";' onblur='active=\"content\";'></div>",n+="<div id='status' class='status'></div>",getObj("data").innerHTML=n,getObj("content").scrollLeft=e,getObj("content").scrollTop=t,mouseoverCell(currRow,currCol),clipboard_mode!=""&&(m="#DDDDFF",clipboard_mode=="cut"&&(m="#FFDDDD"),clipboard_range.length>0?highlightRange(clipboard_range,"",m):(g=resolveCell(clipboard_row,clipboard_col),g&&(g.style.backgroundColor=m))),getObj("focus").focus()}function showHeaderFooter(e){if(isWriteable)return;e?(getObj("content").style.top="23px",getObj("content").style.bottom="18px",getObj("header").style.display="",getObj("footer").style.display="",getObj("status").style.display=""):(getObj("content").style.top="0px",getObj("content").style.bottom="0px",getObj("header").style.display="none",getObj("footer").style.display="none",getObj("status").style.display="none")}function previewValue(){var e=getObj("value").value;!getObj("value").disabled&&(e.length>25||e.indexOf("\\n")!=-1||e.indexOf("html:")==0)&&(getObj("multiline").style.display="inline",getObj("multiline").contentWindow.update&&getObj("multiline").contentWindow.update()),previewField()}function previewField(){var e,t,n=resolveCell(currRow,currCol);value=previewCell(getObj("value").value,0),value=formatValue(value,getObj("styling").value),e=htmlEscape(formatStyle(getObj("styling").value,value),!1),currRow==-1?(value!=""&&(value+=" - "),value+=buildColName(currCol)):currCol==-1&&(value!=""&&(value+="\\n"),value+=currRow+1),value=htmlEscape(value,!0),t="<div "+(e?"style='"+e+"'":"")+">"+value+"</div>",n.innerHTML=t,t.indexOf("<img")!=-1&&(n.style.height=n.offsetHeight+"px"),(currRow==-1||currCol==-1)&&highlightCellHeader(currRow,currCol)}function previewMultiline(e){getObj("value").value=e.replace(/\n/g,"\\n").replace(/\r/g,""),previewField()}function log(e){var t;getObj("tconsole")||(t=document.createElement("textarea"),t.id="tconsole",document.body.appendChild(t)),getObj("tconsole").value+=getObj("tconsole").value.split("\n").length+": "+e+"\n"}function manual(){window.open("manual.html","manual","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600")}function isWritable(e){return e.indexOf("readonly:true")==-1&&isWriteable?!0:!1}function getCells(e,t,n){return cells[e]&&cells[e][t]&&cells[e][t].length==4?cells[e][t][n]:""}function getCellsR(e,t,n){var r=resolveCellArray(e,t);return getCells(r[0],r[1],n)}function getCells2(e,t,n,r){var i=colstrToColnum(e),s=showCell(t-1,i,r+1),o=parseFloat(s);return o==s?o:s}function getCells3(e,t,n,r,i,s){var o,u,a,f,l=[],c=colstrToColnum(e),h=colstrToColnum(n);if(c>h||t>r)return Array("error");for(o=t;o<=r;o++)for(u=c;u<=h;u++)a=showCell(o-1,u,s+1),f=parseFloat(a),f==a?l[l.length]=f:l[l.length]=a;return l}function getCellStyle(e,t,n){var r=getCells(e,t,1),i=RegExp(n+":(.*?);","i");return(p=i.exec(r))?r=parseInt(p[1]):r=0,r}function setCells(e,t,n,r){return cells[e]||(cells[e]=[]),cells[e][t]||(cells[e][t]=["","","",""]),cells[e][t][n]!=r?(cells[e][t][n]=r,!0):!1}function setCellsR(e,t,n,r){var i=resolveCellArray(e,t);return setCells(i[0],i[1],n,r)}function loadScriptFile(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,document.getElementsByTagName("head").item(0).appendChild(t)}function loadStyleFile(e){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.getElementsByTagName("head").item(0).appendChild(t)}function load(code){var i;if(code.indexOf("dbCells")==-1){code.indexOf(tab)==-1?cells=loadCSV(code):cells=loadTSV(code);if(!cells)return}else{try{eval(code)}catch(err){return}window.registerFuncs=registerFuncs;if(registerFuncs)for(i=0;i<registerFuncs.length;i++)window[registerFuncs[i]]=eval(registerFuncs[i]);cells=[];try{for(i=0;i<dbCells.length;i++){if(!dbCells[i])continue;cells[dbCells[i][1]]||(cells[dbCells[i][1]]=[]),cells[dbCells[i][1]][dbCells[i][0]]=[dbCells[i][2],dbCells[i][3],dbCells[i][4],""]}}catch(err){return}}typeof cells[-2]!="undefined"?showColumnGroups=!0:showColumnGroups=!1,active="content",getObj("source").style.display="none",getObj("data").style.display="inline",display()}function cancelLoad(){active="content",getObj("source").style.display="none",getObj("data").style.display="inline",display()}function loadCSV(e){var t;e=e.replace(/([^,])""([^,])/g,"$1#quot#$2").replace(/\r/g,""),e=e.replace(/(".*?")/g,function(e){return e.replace(/,/g,"#comm#")}),e=e.replace(/([^,])""([^,])/g,"$1#quot#$2"),e=e.split("\n");for(t=0;t<e.length;t++)e[t]='["'+e[t].replace(/^"|"\s*$/g,"").replace(/"?,"?/g,'","')+'"]',t!=e.length-1&&(e[t]+=",");return e="dbCells = [\n"+e.join("\n")+"\n];\n",e=e.replace(/#comm#/g,",").replace(/#quot#/g,'\\"'),loadDbCells(e)}function loadTSV(e){var t;e=e.replace(/^\/\/.*?\n/g,"").replace(/\r/g,"").split("\n");for(t=0;t<e.length;t++)e[t]='["'+e[t].replace(/"/g,'\\"').replace(/	/g,'","')+'"]',t!=e.length-1&&(e[t]+=",");return e="dbCells = [\n"+e.join("\n")+"\n];\n",e=e.replace(/\[""\],\n/g,""),loadDbCells(e)}function loadDbCells(code){var i,i2;try{eval(code)}catch(err){return!1}cells=[];try{for(i=0;i<dbCells.length;i++)for(i2=0;i2<dbCells[i].length;i2++)dbCells[i][i2]&&(cells[i-1]||(cells[i-1]=[]),cells[i-1][i2]=[dbCells[i][i2]+"","","",""])}catch(err){return!1}return cells}function save(e){var t;active="code",getObj("status").innerHTML="",t="",e=="csv"?t=cellsToCSV():e=="tsv"?t=cellsToTSV():t=cellsToJS(),getObj("data").style.display="none",getObj("source").style.display="inline",getObj("code").value=t}function cellsToJS(){var i,i2,out="";out+="dbCells = [\n";for(i=-2;i<cells.length;i++)if(cells[i]){for(i2=-1;i2<cells[i].length;i2++){if(!cells[i][i2])continue;if(cells[i][i2][0]==""&&cells[i][i2][1]=="")continue;out+="  ["+i2+","+i+',"'+strescape(cells[i][i2][0])+'","'+strescape(cells[i][i2][1])+'"',cells[i][i2][2]&&isNaN(cells[i][i2][2])?out+=',"'+strescape(cells[i][i2][2])+'"':cells[i][i2][2]&&(out+=","+cells[i][i2][2]),out+="], // "+buildColName(i2)+(i+1)+"\n"}out+="\n"}cells.length>0?out=out.substring(0,out.length-2)+"\n];\n":out+="];\n";if(registerFuncs){out+="\nvar registerFuncs = [";for(i=0;i<registerFuncs.length;i++)out+='"'+registerFuncs[i]+'",';out=out.substring(0,out.length-1)+"];\n\n";for(i=0;i<registerFuncs.length;i++)out+=eval(registerFuncs[i])+"\n\n";out=out.substring(0,out.length-2)}return out}function cellsToCSV(){var e,t,n,r="";for(e=-1;e<cells.length;e++)if(cells[e]){for(t=0;t<cells[e].length;t++)cells[e][t]&&cells[e][t][0]?e==-1&&cells[e][t][2]?r+='"'+cells[e][t][2].replace(/\\/g,"\\\\").replace(/"/g,'""')+'",':(n=showCell(e,t),isNaN(n)?r+='"'+n.replace(/\\/g,"\\\\").replace(/"/g,'""')+'",':r+=n+","):r+=",";r=r.substring(0,r.length-1)+"\n"}else r+=",\n";return r}function cellsToTSV(){var e,t,n="// "+trans("Copy / paste this code to other spreadsheet applications (e.g. Excel)")+":\n\n";for(e=-1;e<cells.length;e++)if(cells[e]){for(t=0;t<cells[e].length;t++)cells[e][t]&&cells[e][t][0]?e==-1&&cells[e][t][2]?n+=cells[e][t][2]+tab:n+=showCell(e,t)+tab:n+=tab;n=n.substring(0,n.length-1)+"\n"}else e==-1&&(n+=tab+"\n");return n}function addHiddenParam(e,t,n){param=document.createElement("input"),e.appendChild(param),param.setAttribute("type","hidden"),param.setAttribute("name",t),param.setAttribute("value",n)}function saveSGS(){var e,t,n,r,i,s,o,u="index.php?view="+escape(sgs_view)+"&folder="+escape(sgs_folder);sgs_view=="edit"?u+="&form_submit_edit=checked":u+="&form_submit_create=checked",e="",t=0,n=document.createElement("form");for(r=0;r<cells.length;r++)if(cells[r]){i=r,cells[-1][0][2]=="id"&&cells[r][0]&&cells[r][0][3]!=""&&(i=cells[r][0][3]),addHiddenParam(n,"form_fields[]",i),addHiddenParam(n,"form_"+i+"_folder",escape(sgs_folder)),t++;for(s=0;s<cells[-1].length;s++)o="",cells[-1]&&cells[-1][s]&&(cells[-1][s][2]?o=cells[-1][s][2]:o=cells[-1][s][0]),o&&addHiddenParam(n,"form_"+i+"_"+o,showCell(r,s))}n.action=u+"&limit="+t,n.method="POST",n.style.display="none",document.body.appendChild(n),n.submit()}function loadSheetFromUrl(e){var t=document.createElement("script");t.type="text/javascript",t.onload=t.onreadystatechange=function(e){agent==="msie"?(t.readyState==="loaded"||t.readyState==="complete")&&load("// dbCells"):agent==="opera"?typeof e!="string"&&e.type==="load"&&load("// dbCells"):typeof e!="string"&&(e.type==="load"||e.type==="readystatechange"&&(e.target.readyState==="complete"||e.target.readyState==="loaded"))&&load("// dbCells")},t.src=e,document.getElementsByTagName("head").item(0).appendChild(t)}function resetPath(){window.parent.sendMsg($checknum,"resetPath","")}function saveCode(){window.parent.sendMsg($checknum,"saveFile","<arg1>"+Base64.encode(cellsToJS())+"</arg1>")}function saveCodeClose(){window.parent.sendMsg($checknum,"yDelete","<arg1>"+Base64.encode(cellsToJS())+"</arg1>")}function saveAs(){window.parent.sendMsg($checknum,"saveAs","")}function loadCode(){window.parent.sendMsg($checknum,"openFile","")}function help(){window.parent.sendMsg($checknum,"help","")}function fullScreen(){window.parent.sendMsg($checknum,"fullScreen","")}function print(){var e,t=document.getElementById("content").innerHTML;t=t.replace(/(<\/tr>|<\/table>)/g,"$1\n"),e=window.open("","print","toolbar=no,location=no,directories=no,status=no,menubar=yes,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600"),e.document.write("<html><head><link media='all' href='"+printstyle+"' rel='stylesheet' type='text/css'/></head>\n"),e.document.write("<body>\n"+t+"\n</body></html>"),e.document.close(),e.window.print()}function insertRow(){var e,t;for(e=cells.length-1;e>=currRow;e--)if(cells[e])for(t=0;t<cells[e].length;t++){if(!cells[e][t])continue;cells[e+1]||(cells[e+1]=[]),cells[e+1][t]=cells[e][t],cells[e][t]=""}display()}function deleteRow(){var e,t,n,r,i=currRow,s=currRow;multiRange.length>0&&(e=getMultiRange(multiRange),i=e[0],s=e[2]);for(t=i;t<=s;t++)for(n=i;n<cells.length;n++)if(cells[n])for(r=0;r<cells[n].length;r++){cells[n+1]||(cells[n+1]=[]),!cells[n+1][r]&&cells[n][r]&&(cells[n][r]="");if(!cells[n+1][r]&&!cells[n][r])continue;cells[n][r]=cells[n+1][r],cells[n+1][r]=""}display()}function insertColumn(){var e,t;for(e=0;e<cells.length;e++)if(cells[e])for(t=cells[e].length-1;t>=currCol;t--){if(!cells[e][t])continue;cells[e][t+1]=cells[e][t],cells[e][t]=""}display()}function deleteColumn(){var e,t,n,r,i=currCol,s=currCol;multiRange.length>0&&(e=getMultiRange(multiRange),i=e[1],s=e[3]);for(t=i;t<=s;t++)for(n=0;n<cells.length;n++)if(cells[n])for(r=i;r<cells[n].length;r++){!cells[n][r+1]&&cells[n][r]&&(cells[n][r]="");if(!cells[n][r+1]&&!cells[n][r])continue;cells[n][r]=cells[n][r+1],cells[n][r+1]=""}display()}function scroll(){scrollDown(),scrollUp(),scrollRight(),scrollLeft()}function scrollUp(){var e,t=resolveCell(currRow,currCol),n=findPosY(t);n<getObj("content").scrollTop+100&&getObj("content").scrollTop>n-100&&(getObj("content").scrollTop=n-100),e=findPosX(t),e<getObj("content").scrollLeft+200&&getObj("content").scrollLeft>e-150&&(getObj("content").scrollLeft=e-150)}function scrollDown(){var e,t,n,r,i=resolveCell(currRow,currCol),s=findPosY(i),o=return_height();i&&s+i.offsetHeight+100>o&&(e=s+i.offsetHeight+100-o,e>getObj("content").scrollTop&&(getObj("content").scrollTop=e)),t=findPosX(i),n=return_width(),i&&t+i.offsetWidth+100>n&&(r=t+i.offsetWidth+100-n,r>getObj("content").scrollLeft&&(getObj("content").scrollLeft=r))}function scrollLeft(){scrollUp()}function scrollRight(){scrollDown()}function removeSelectedCell(){var e,t,n,r;if(multiRange.length>0){e=getMultiRange(multiRange);for(t=e[0];t<=e[2];t++)for(n=e[1];n<=e[3];n++)isWritable(getCellsR(t,n,1))&&(setCellsR(t,n,0,""),setCellsR(t,n,1,""),auto_recalc||(r=resolveCell(t,n),r.innerHTML="<div>&nbsp;</div>"))}else removeCell(currRow,currCol),!auto_recalc&&isWritable(getCellsR(currRow,currCol,1))&&(r=resolveCell(currRow,currCol),r.innerHTML="<div>&nbsp;</div>");auto_recalc&&display()}function cutcopy(e,t){var n;if(!isWriteable)return;clipboard_range.length>0?highlightRange(clipboard_range,"",""):clipboard_mode&&(n=resolveCell(clipboard_row,clipboard_col),n&&(n.style.backgroundColor="")),clipboard_mode=e,clipboard_row=currRow,clipboard_col=currCol,clipboard_range=getMultiRange(multiRange),multiRange.length>0?highlightRange(multiRange,"",t):(n=resolveCell(currRow,currCol),n&&(n.style.backgroundColor=t))}function paste(){var e,t,n,r,i,s,o;if(clipboard_range.length>0){e=getMultiRange(clipboard_range),t=[currRow,currCol,currRow+e[2]-e[0],currCol+e[3]-e[1]],multiRange.length>0&&(multiRange[0]!=multiRange[2]||multiRange[1]!=multiRange[3])&&(t=getMultiRange(multiRange)),n=0,r=0;if(t[0]>=e[0]&&t[1]>=e[1]||t[0]>e[0]&&t[1]<e[1])for(i=t[2];i>=t[0];i--){n=(i-t[0])%(e[2]-e[0]+1);for(s=t[3];s>=t[1];s--)r=(s-t[1])%(e[3]-e[1]+1),copyCell(e[0]+n,e[1]+r,i,s),o=resolveCell(e[0]+n,e[1]+r),o&&(o.style.backgroundColor="")}else for(i=t[0];i<=t[2];i++){n=(i-t[0])%(e[2]-e[0]+1);for(s=t[1];s<=t[3];s++)r=(s-t[1])%(e[3]-e[1]+1),copyCell(e[0]+n,e[1]+r,i,s),o=resolveCell(e[0]+n,e[1]+r),o&&(o.style.backgroundColor="")}if(clipboard_mode=="cut"){for(i=e[0];i<=e[2];i++)for(s=e[1];s<=e[3];s++)(i<t[0]||i>t[2]||s<t[1]||s>t[3])&&removeCell(i,s);clipboard_mode=""}}else{if(multiRange.length<=0||multiRange[0]==multiRange[2]&&multiRange[1]==multiRange[3])copyCell(clipboard_row,clipboard_col,currRow,currCol),clipboard_mode=="cut"&&(clipboard_row!=currRow||clipboard_col!=currCol)&&removeCell(clipboard_row,clipboard_col);else{t=getMultiRange(multiRange);for(i=t[2];i>=t[0];i--)for(s=t[3];s>=t[1];s--)copyCell(clipboard_row,clipboard_col,i,s);clipboard_mode=="cut"&&(clipboard_row<t[0]||clipboard_row>t[2]||clipboard_col<t[1]||clipboard_col>t[3])&&removeCell(clipboard_row,clipboard_col)}clipboard_mode=="cut"&&(clipboard_mode="")}display()}function sortNum(e){return isNaN(e)?e.charAt(0).toLowerCase().charCodeAt(0):parseFloat(e)}function sortCells(e,t){return e[currCol]&&t[currCol]?e[currCol][3]==""?1:t[currCol][3]==""?-1:(e=sortNum(e[currCol][3]),t=sortNum(t[currCol][3]),e-t):e[currCol]?1:-1}function sort(e){var t,n,r,i;if(multiRange.length>0){t=getMultiRange(multiRange),n=[];for(r=t[0];r<=t[2];r++)for(i=t[1];i<=t[3];i++)n[r]||(n[r]=[]),cells[r]&&cells[r][i]&&(n[r][i]=cells[r][i]);e?n=n.sort(sortCells):n=n.sort(sortCells).reverse();for(r=t[0];r<=t[2];r++)for(i=t[1];i<=t[3];i++)cells[r]||(cells[r]=[]),cells[r][i]=n[r][i]}else e?cells=cells.sort(sortCells):cells=cells.sort(sortCells).reverse();display()}function buildStatus(e,t){var n,r,i,s="",o=getCellsR(-1,t,0),u=getCellsR(-2,t,0),a=getCellsR(e,t,2);a&&e!=-1&&(s+=a+" - "),o?(n=getCellsR(-1,t,2),u&&(s+=u+": "),s+=(n?n:o)+" - "):u&&(s+=u+" - "),r=getCellsR(e,-1,0),r&&(i=getCellsR(e,-1,2),s+=(i?i:r)+" - "),getObj("status").innerHTML=s+buildColName(t)+(e+1),isMouseDown&&(markCell(e,t),highlightRange(multiRange,"cell"),multiRange[2]=e,multiRange[3]=t,highlightRange(multiRange,"cell_highlight_over"))}function highlightRange(e,t,n){var r,i,s;if(e.length==0)return!1;r=getMultiRange(e);for(i=r[0];i<=r[2];i++)for(s=r[1];s<=r[3];s++)obj=resolveCell(i,s),obj&&t?obj.className=t:!t&&obj&&(obj.style.backgroundColor=n)}function getMultiRange(e){var t,n,r,i;return e.length==0?[]:(t=e[0]>e[2]?e[2]:e[0],n=e[0]>e[2]?e[0]:e[2],r=e[1]>e[3]?e[3]:e[1],i=e[1]>e[3]?e[1]:e[3],[t,r,n,i])}function mousedown(e,t){getObj("styling").disabled&&(document.onmousedown=function(){return!1},document.onselectstart=function(){return!1},isMouseDown=1,highlightRange(multiRange,"cell"),multiRange=[e,t,e,t],highlightRange(multiRange,"cell_highlight_over"))}function mouseup(){getObj("styling").disabled&&(document.onmousedown="",document.onselectstart="",isMouseDown=0)}function markCell(e,t){highlightCell(e,t,"cell_highlight_over"),highlightCellHeader(e,t),currRow=e,currCol=t,getObj("value").value=getCellsR(e,t,0),getObj("styling").value=getCellsR(e,t,1),getObj("field").value=buildColName(t)+(e+1)}function mouseoverCell(e,t){var n,r,i;getObj("styling").disabled?e==currRow&&t==currCol&&getObj("field").value?editCell(e,t,0):(markCell(e,t),buildStatus(e,t)):getObj("value").disabled||(n=getObj("value"),r=buildColName(t)+(e+1),n.selectionStart?(i=n.selectionStart,n.value=n.value.substring(0,n.selectionStart)+r+n.value.substring(n.selectionStart),n.selectionStart=i+r.length,n.selectionEnd=i+r.length,n.focus()):document.selection&&(n.value+=r),previewValue())}function highlightCell(e,t,n){var r=resolveCell(currRow,currCol);r&&(r.className="cell"),r=resolveCell(e,t),r&&(r.className=n)}function highlightCellHeader(e,t){var n,r=resolveCell(-1,currCol);r&&(r.className="border"),r=resolveCell(currRow,-1),r&&(r.className="border"),n=-1,e<-1&&(n=-2),r=resolveCell(n,t),r&&(r.className="border_highlight"),e>=-1&&(r=resolveCell(e,-1),r&&(r.className="border_highlight"))}function showCell(row,col,calls){var cmd,token,openToken,sequence,i;typeof calls=="undefined"&&(calls=0),value=getCells(row,col,0);if(calls>25)value="undefined";else if(value!=""&&value.charAt(0)=="="){cmd="",token="",openToken="",sequence="";for(i=0;i<value.length;i++)token=value.charAt(i),sequence+=token,(token=="'"||token=='"')&&openToken==""||i==value.length-1?(openToken==""&&(sequence=sequence.replace(/([A-Z]+)([0-9]+):([A-Z]+)([0-9]+)/g,"getCells3('$1',$2,'$3',$4,0,"+(calls+1)+")"),sequence=sequence.replace(/([A-Z]+)([0-9]+)/g,"getCells2('$1',$2,0,"+(calls+1)+")")),openToken=token,cmd+=sequence,sequence=""):token==openToken&&value.charAt(i-1)!="\\"&&(openToken="",cmd+=sequence,sequence="");try{eval("value"+cmd)}catch(err){}}return cells[row]&&cells[row][col]&&(cells[row][col][3]=value),value}function previewCell(value,calls){var cmd,token,openToken,sequence,i,nvalue;if(value==""||value.charAt(0)!="=")return value;if(calls>25)return"undefined";cmd="",token="",openToken="",sequence="";for(i=0;i<value.length;i++)token=value.charAt(i),sequence+=token,(token=="'"||token=='"')&&openToken==""||i==value.length-1?(openToken==""&&(sequence=sequence.replace(/([A-Z]+)([0-9]+):([A-Z]+)([0-9]+)/g,"getCells3('$1',$2,'$3',$4,0,"+(calls+1)+")"),sequence=sequence.replace(/([A-Z]+)([0-9]+)/g,"getCells2('$1',$2,0,"+(calls+1)+")")),openToken=token,cmd+=sequence,sequence=""):token==openToken&&value.charAt(i-1)!="\\"&&(openToken="",cmd+=sequence,sequence="");nvalue="";try{eval("nvalue"+cmd)}catch(err){}return nvalue!=null&&(nvalue+"").length>0?nvalue:value}function gotoCell(e){var t,n,r=RegExp("([@A-Z]+)([0-9]+)","g");if(p=r.exec(e)){t=colstrToColnum(p[1]),n=p[2]-1;if(t>=-1&&n>=0){getObj("focus").focus();if(t!=currCol||n!=currRow){if(t>=cols||n<=rows)col0=t-t%cols,row0=n-n%rows,display();mouseoverCell(n,t),scroll()}return}}}function editCell(e,t,n){active="content";if(!isWriteable)return;getObj("styling").disabled||cancelCell(),highlightCell(e,t,"cell_highlight"),highlightCellHeader(e,t),currRow=e,currCol=t,isWritable(getCellsR(e,t,1))&&(getObj("value").disabled=!1),getObj("styling").disabled=!1,getObj("save").disabled=!1,getObj("cancel").disabled=!1,getObj("cols")&&(getObj("cols").disabled=!0),getObj("rows")&&(getObj("rows").disabled=!0),getObj("field").disabled=!0,getObj("styling").value=getCellsR(e,t,1),n>32&&agent=="firefox"&&!getObj("value").disabled?getObj("value").value=String.fromCharCode(n):getObj("value").value=getCellsR(e,t,0),getObj("value").disabled?getObj("styling").focus():getObj("value").focus()}function copyCell(e,t,n,r){if(!isWritable(getCellsR(n,r,1)))return;if(e!=n||t!=r)setCells(n,r,0,getCellsR(e,t,0)),setCells(n,r,1,getCellsR(e,t,1))}function saveCell(){var e=setCellsR(currRow,currCol,0,getObj("value").value),t=setCellsR(currRow,currCol,1,getObj("styling").value);e||t?auto_recalc?display():(disableEdit(),previewValue()):cancelCell()}function disableEdit(){getObj("value").blur(),highlightCell(currRow,currCol,"cell_highlight_over"),getObj("value").disabled=!0,getObj("styling").disabled=!0,getObj("save").disabled=!0,getObj("cancel").disabled=!0,getObj("cols")&&(getObj("cols").disabled=!1),getObj("rows")&&(getObj("rows").disabled=!1),getObj("field").disabled=!1,getObj("multiline").style.display="none",getObj("content").style.overflow="auto"}function cancelCell(){disableEdit(),getObj("value").value=getCellsR(currRow,currCol,0),getObj("styling").value=getCellsR(currRow,currCol,1),previewValue()}function removeCell(e,t){if(!isWritable(getCellsR(e,t,1)))return;setCellsR(e,t,0,""),setCellsR(e,t,1,"")}function resolveCell(e,t){var n=getObj(e+"_"+t);return!n&&marks[e]&&marks[e][t]&&(n=getObj(marks[e][t][0]+"_"+marks[e][t][1])),n}function resolveCellArray(e,t){var n,r=getObj(e+"_"+t);return!r&&marks[e]&&marks[e][t]&&(n=marks[e][t],e=n[0],t=n[1]),[e,t]}function getSize(e){var t=0,n=0;return typeof window.innerWidth=="number"?(t=window.innerWidth,n=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(t=window.document.documentElement.clientWidth,n=window.document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)?(t=document.body.clientWidth,n=document.body.clientHeight):self.screen.height&&self.screen.width&&(t=self.screen.width,n=self.screen.height),e?t:n}function return_height(){return getSize(0)}function return_width(){return getSize(1)}function getObj(e){return document.getElementById(e)}function getmykey(e){return typeof e=="undefined"?window.event.keyCode:e.keyCode==0&&e.charCode!=0?e.charCode:e.keyCode==0?e.which:e.keyCode}function findPosY(e){var t;if(!e)return 0;t=0;if(e.offsetParent)while(e.offsetParent)t+=e.offsetTop,e=e.offsetParent;else e.y&&(t+=e.y);return t}function findPosX(e){var t;if(!e)return 0;t=0;if(e.offsetParent)while(e.offsetParent)t+=e.offsetLeft,e=e.offsetParent;else e.x&&(t+=e.x);return t}function strescape(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function htmlEscape(e,t){return e==null||e.length==0?t?"&nbsp;":"":(e=new String(e),e.indexOf("html:")==0?e=e.substring(5):(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/'/g,"&#039;").replace(/"/g,"&quot;"),e=e.replace(/([^\s$]+@[^\s$]+)/g,"<a href='$1'>$1</a>"),e=e.replace(/img:((http[s]?:\/\/[^\s$]+\.(gif|jpg|png))|(graphs\.php\?.*?$))/g
,"<img src='$1'>"),e=e.replace(/(^|[^'])(http[s]?:\/\/[^\s$]+)/g,"$1<a target='_blank' href='$2'>$2</a>"),e=e.replace(/\\n/g,"<br>")),e)}function handleErr(){return!0}function buildColName(e){var t="",n="";return e>=702&&(t=(Math.floor(e/676)-1)%26,n+=String.fromCharCode(t+65)),e>=26&&(t=(Math.floor(e/26)-1)%26,n+=String.fromCharCode(t+65)),n+=String.fromCharCode(e%26+65),n}function colstrToColnum(e){var t,n=0;for(t=0;t<e.length;t++)n+=26*(e.length-t-1)+(e.charCodeAt(t)-65);return n}function formatStyle(e,t){return e.indexOf("text-align:")==-1&&t.length>0&&!isNaN((t+"").replace(/[$%,]/g,"").replace("&euro;",""))&&(e+="; text-align:right; white-space:nowrap;",t<0&&e.indexOf("color:")==-1&&(e+="color:#FF0000;")),e.replace(/(format|readonly|colspan|rowspan):.*?;/ig,"")}function formatValue(e,t){return t.indexOf("format:")!=-1?t.indexOf("format:euro")!=-1?e=formatNumber(e)+" &euro;":t.indexOf("format:dollar")!=-1?e="$"+formatNumber(e):t.indexOf("format:percent")!=-1?e=(e*100).toFixed(2)+"%":t.indexOf("format:number")!=-1?e=formatNumber(e):t.indexOf("format:datefulltime")!=-1?e=formatDateFullTime(e):t.indexOf("format:datetime")!=-1?e=formatDateTime(e):t.indexOf("format:datefull")!=-1?e=formatDateFull(e):t.indexOf("format:date")!=-1?e=formatDate(e):t.indexOf("format:time")!=-1&&(e=formatTime(e)):!isNaN(e)&&e!=0&&(e=formatNumber(e).replace(/\.00$/,"")),e}function formatDate(e){var t;return isNaN((new Date(e)).getHours())&&(e=e.replace(/(\d{1,2})\.(\d{1,2})\.(\d{2,4})/,"$2/$1/$3")),t=new Date(e),t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()}function formatDateFull(e){var t,n,r;return isNaN((new Date(e)).getHours())&&(e=e.replace(/(\d{1,2})\.(\d{1,2})\.(\d{2,4})/,"$2/$1/$3")),t=new Date(e),n=[trans("January"),trans("February"),trans("March"),trans("April"),trans("May"),trans("June"),trans("July"),trans("August"),trans("September"),trans("October"),trans("November"),trans("December")],r=[trans("Sunday"),trans("Monday"),trans("Tuesday"),trans("Wednesday"),trans("Thursday"),trans("Friday"),trans("Sunday")],r[t.getDay()]+", "+n[t.getMonth()]+" "+t.getDate()+" "+t.getFullYear()}function formatTime(e){var t,n;return isNaN((new Date(e)).getHours())&&(e=e.replace(/\d+\.\d+\.\d+/,"$2/$1/$3"),e.length<12&&(e="01/01/01 "+e)),t=new Date(e),hour=t.getHours(),n="am",hour>11&&(n="pm"),hour>12&&(hour-=12),hour==0&&(hour=12),hour+":"+t.getMinutes()+":"+t.getSeconds()+" "+n}function formatDateTime(e){return formatDate(e)+" "+formatTime(e)}function formatDateFullTime(e){return formatDateFull(e)+", "+formatTime(e)}function formatNumber(e){var t,n="",r="";e<0&&(r="-",e*=-1),number=Math.floor((e-0).toFixed(2))+"";if(number.length>3){t=number.length%3,n=t==0?"":number.substring(0,t);for(i=0;i<Math.floor(number.length/3);i++)t==0&&i==0?n+=number.substring(t+3*i,t+3*i+3):n+=","+number.substring(t+3*i,t+3*i+3)}else n+=number;return e-number!=0&&(n+=Math.abs(e-number).toFixed(2).replace("0.",".")),r+n}function param(e){return e.join&&(e=e.join(",")),e.replace?escape(e):e}function graph(e,t,n,r,i,s,o,u){var a="img:graphs.php?type="+param(e)+"&title="+param(t);return a+="&data="+param(n)+"&keys="+param(r),typeof i!="undefined"&&(a+="&xtitle="+param(i)),typeof s!="undefined"&&(a+="&ytitle="+param(s)),typeof o!="undefined"&&(a+="&width="+o),typeof u!="undefined"&&(a+="&height="+u),a}function graph2(e,t,n,r,i,s,o,u,a){var f="img:graphs.php?type="+param(e)+"&title="+param(t);return f+="&data="+param(n)+"&data2="+param(r)+"&keys="+param(i),typeof s!="undefined"&&(f+="&xtitle="+param(s)),typeof o!="undefined"&&(f+="&ytitle="+param(o)),typeof u!="undefined"&&(f+="&width="+u),typeof a!="undefined"&&(f+="&height="+a),f}function sum(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t];return n}function min(e){var t,n=0;e.length>0&&(n=e[0]);for(t=0;t<e.length;t++)e[t]<n&&(n=e[t]);return n}function max(e){var t,n=0;e.length>0&&(n=e[0]);for(t=0;t<e.length;t++)e[t]>n&&(n=e[t]);return n}function avg(e){var t,n=0;if(e.length==0)return 0;for(t=0;t<e.length;t++)n+=e[t];return Math.round(1e3*(n/e.length))/1e3}function count(e){var t=0;return e.length}var init_data,auto_recalc,cols,rows,row0,col0,col_min_width,cells,marks,view,currRow,currCol,multiRange,clipboard_row,clipboard_col,clipboard_range,clipboard_mode,active,showColumnGroups,allowPaging,registerFuncs,isMouseDown,isShiftDown,sgs_folder,sgs_view,saveMethod,closeMethod,isWriteable,tab,printstyle,Base64,myPid=$myPid,myChecknum=$checknum,USERTHEME="$usertheme",agent=navigator.userAgent.toLowerCase();agent.indexOf("konqueror")!=-1?agent="konqueror":agent.indexOf("safari")!=-1?agent="safari":agent.indexOf("opera")!=-1?agent="opera":agent.indexOf("firefox")!=-1?agent="firefox":agent.indexOf("msie")!=-1&&(agent="msie"),window.onerror=handleErr,agent=="msie"||agent=="safari"?document.onkeydown=keypress:document.onkeypress=keypress,init_data="",auto_recalc=!0,cols=13,rows=30,row0=0,col0=0,col_min_width="90px",cells=[],marks=[],view="values",currRow=0,currCol=0,multiRange=[],clipboard_row=0,clipboard_col=0,clipboard_range=[],clipboard_mode="",active="",showColumnGroups=!1,allowPaging=!0,registerFuncs="",isMouseDown=0,isShiftDown=0,sgs_folder=0,sgs_view="",saveMethod="save('js')",closeMethod="",isWriteable=!0,tab=String.fromCharCode(9),printstyle="index.php?theme="+USERTHEME+"&extern=css/apps/eyeSheets/print.css",Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="",n,r,i,s,o,u,a,f=0;e=Base64._utf8_encode(e);while(f<e.length)n=e.charCodeAt(f++),r=e.charCodeAt(f++),i=e.charCodeAt(f++),s=n>>2,o=(n&3)<<4|r>>4,u=(r&15)<<2|i>>6,a=i&63,isNaN(r)?u=a=64:isNaN(i)&&(a=64),t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a);return t},decode:function(e){var t="",n,r,i,s,o,u,a,f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length)s=this._keyStr.indexOf(e.charAt(f++)),o=this._keyStr.indexOf(e.charAt(f++)),u=this._keyStr.indexOf(e.charAt(f++)),a=this._keyStr.indexOf(e.charAt(f++)),n=s<<2|o>>4,r=(o&15)<<4|u>>2,i=(u&3)<<6|a,t+=String.fromCharCode(n),u!=64&&(t+=String.fromCharCode(r)),a!=64&&(t+=String.fromCharCode(i));return t=Base64._utf8_decode(t),t},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t},_utf8_decode:function(e){var t="",n=0,r=c1=c2=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|c2&63),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63),n+=3);return t}};