function checkEnterKey(e){var t;return e.which?t=e.which:t=e.keyCode,t===13?!0:!1}function cookieEnabled(){var e;if(typeof navigator.cookieEnabled=="boolean"&&navigator.cookieEnabled)return navigator.cookieEnabled;e=0;while(document.cookie.indexOf("cookieEnabled-"+e)!==-1)e+=1;return document.cookie="cookieEnabled-"+e,document.cookie.indexOf("cookieEnabled-"+e)!==-1?!0:!1}function evilEval(content){return eval(content)}function eyeParam(e,t,n){return e=e+"",t=t+"",n||(e=htmlspecialchars(e),t=htmlspecialchars(t)),"<"+e+">"+t+"</"+e+">"}function fixPNG(e,t){IEversion&&IEversion<7&&(e.src||(e=xGetElementById(e)),e.src.substr(e.src.length-4).toLowerCase()===".png"&&e.src.substr(e.src.length-24).toLowerCase()!=="apps/eyex/gfx/spacer.gif"&&(t||(t="scale"),e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e.src+"', sizingMethod='"+t+"')",e.src="index.php?extern=apps/eyeX/gfx/spacer.gif"))}function getArrayArg(e){var t,n,r,i,s,o=e.split('""');for(t=0;t<o.length;t+=1){i=o[t].replace(/\\\"/,'"'),i=i.replace(/\\\'/,"'"),n=o[t];while(i!==n)n=i,i=i.replace(/\\\"/,'"'),i=i.replace(/\\\'/,"'");o[t]=i}r=[],t=0;for(s in o)o.hasOwnProperty(s)&&(r[t]=o[s],t+=1);return r}function printToTty(e,t){var n=document.getElementById(e+"_tty");if(!n)return!1;n.tagName==="DIV"?(n.appendChild(document.createTextNode(t)),n.appendChild(document.createElement("br"))):n.tagName==="INPUT"&&(n.value+=t,n.value+="\n")}function raiseZIndex(e){return zindex+=e,zindex}function setWallpaper(e,t,n,r){var i=document.getElementById("eyeWallpaper");i.style.backgroundImage="url('"+e+"')",parseInt(t,10)?i.style.backgroundRepeat="repeat":i.style.backgroundRepeat="no-repeat",n?i.style.backgroundPosition="center":i.style.backgroundPosition="left top",r?i.style.backgroundColor=r:i.style.backgroundColor="transparent"}function updateOpacity(e,t,n,r,i){var s,o;r=Math.round(r/100),s=0;if(t>n){for(o=t;o>=n;o-=1)setTimeout("updateOpacityOnce("+o+", '"+e+"');",s*r),s+=1;i&&setTimeout(i,s*r)}else if(t<n){for(o=t;o<=n;o+=1)setTimeout("updateOpacityOnce("+o+", '"+e+"');",s*r),s+=1;i&&setTimeout(i,s*r)}}function updateOpacityOnce(e,t){var n=xGetElementById(t);n.style.opacity=e/100,n.style.filter="alpha(opacity="+e+")",e?n.style.display==="none"&&(n.style.display="block"):n.style.display="none"}function addClickHandler(e,t){EventHandler.Add("click",e,t)}function addFriendClick(e,t){EventHandler.AddFriend("click",e,t)}function delClickHandler(e){EventHandler.Remove("click",e)}function noviewLoading(){return loadingRequests<=0&&(loadingRequests=0,navigator.appVersion.indexOf("Mac")!==-1?oCursor.style.display="none":oApps.style.cursor="auto"),!0}function notifyEndOfLoadingRequest(){return!ios&&!android&&!windows_phone&&(loadingRequests-=1,noviewLoading()),!0}function viewLoading(){return navigator.appVersion.indexOf("Mac")!==-1?(oCursor.style.top=mouseY-14+"px",oCursor.style.left=mouseX+10+"px",oCursor.style.display="block"):oApps.style.cursor="url(index.php?theme="+USERTHEME+"&extern=images/desktop/loadingcursor/loading.cur), wait",!0}function notifyLoadingRequest(){var e;return!ios&&!android&&!windows_phone?(loadingRequests+=1,e=setTimeout(viewLoading,TimeViewClock),e):!0}function resetLoadingRequests(){return!ios&&!android&&!windows_phone&&(loadingRequests=0,viewLoading()),!0}function dhtmlLoadCSS(e,t){var n=document.createElement("link");n.setAttribute("href",e),n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("id",t),document.getElementsByTagName("head")[0].appendChild(n)}function dhtmlLoadScript(e){var t=document.createElement("script");t.src=e,t.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(t)}function dhtmlRemoveCSS(e){var t=document.getElementById(e);t&&document.getElementsByTagName("head")[0].removeChild(t)}function getNodeValue(e){return e?typeof e.textContent!="undefined"?e.textContent:e.firstChild.nodeValue:""}function updateCss(e,t,n){document.getElementById(e).style[t]=n}function createLayer(e,t,n){var r,i=document.createElement("div");i.setAttribute("id",e),i.className=n,i.style.display="none",r=document.getElementById(t),r.appendChild(i)}function fadeInLayer(e,t,n,r){var i,s=document.getElementById(e);s&&(i='hideLayer("'+e+'");',updateOpacity(e,t,n,r,i))}function fadeOutLayer(e,t,n,r){var i=document.getElementById(e);i&&(updateOpacityOnce(0,e),i.style.display="block",xZIndex(i,zLayers),zLayers+=1,updateOpacity(e,t,n,r,""))}function hideLayer(e){var t=document.getElementById(e);t&&(t.style.display="none",xZIndex(t,1))}function removeLayer(e){var t=document.getElementById("eyeScreen"),n=document.getElementById(e);t&&n&&t.removeChild(n)}function showLayer(e){var t=document.getElementById(e);t&&(t.style.display="block",xZIndex(t,zLayers),zLayers+=1)}function eyeMessageBoxHid(e){!IEversion&&document.getElementById("eyeMessageBox_"+e).style.opacity?updateOpacity("eyeMessageBox_"+e,100,0,1e3,function(){document.getElementById("eyeScreen").removeChild(document.getElementById("eyeMessageBox_"+e))}):document.getElementById("eyeScreen").removeChild(document.getElementById("eyeMessageBox_"+e))}function eyeMessageBoxShow(e){var t,n,r,i;if(e){n=0;while(document.getElementById("eyeMessageBox_"+n))n+=1;t=document.createElement("div"),t.setAttribute("id","eyeMessageBox_"+n),t.className="eyeMessageBox",n>0&&(r=document.getElementById("eyeMessageBox_"+(n-1)),messageBoxDirection?t.style.top=xTop(r)+xHeight(r)+20+"px":t.style.top=xTop(r)-xHeight(r)+20+"px"),i=document.createElement("div"),i.setAttribute("id","eyeMessageBoxText_"+n),i.className="eyeMessageBoxText",i.innerHTML=e,t.appendChild(i),document.getElementById("eyeScreen").appendChild(t),IEversion?document.getElementById("eyeMessageBox_"+n).style.visibility="visible":updateOpacity("eyeMessageBox_"+n,0,100,1e3),setTimeout("eyeMessageBoxHid("+n+")",2e3)}}function getParentWidgetType(e,t){var n;if(!e.parentNode)return!1;n=e.parentNode;for(;;){if(n.widgetType===t)return n;if(!n.parentNode)return!1;n=n.parentNode}}function makeDrag(e,t,n,r,i,s){function f(e,t,n){o=t,u=n}function l(t,s,a){var f;n&&(f="",i&&(f=",'"+i+"'"),evilEval(n+"('"+e+"',"+o+","+u+","+s+","+a+",'"+r+"'"+f+");"))}var o,u,a=xGetElementById(e);if(!a)return!1;s||(a.onmousedown=function(){xZIndex(a,zindex),raiseZIndex(1)}),o=0,u=0,xEnableDrag2(e,f,null,l,t),xShow(a)}function removeWidget(e){var t=xGetElementById(e);t&&t.parentNode.removeChild(t)}function setWidgetPos(e,t,n,r,i,s,o){e=xGetElementById(e),t=xGetElementById(t);if(!e||!t)return!1;o=parseInt(o,10);if(o===1||o===2)i=parseInt(i,10)+(xWidth(t)-xWidth(e))/2;else if(o===4||o===5)i=parseInt(i,10)+xWidth(t)/2;n=parseInt(n,10),!isNaN(i)&&i>=0&&(n===1?e.style.right=parseInt(i,10)+""+"px":e.style.left=parseInt(i,10)+""+"px");if(o===1||o===3)s=parseInt(s,10)+(xHeight(t)-xHeight(e))/2;else if(o===4||o===6)s=parseInt(s,10)+xHeight(t)/2;return r=parseInt(r,10),!isNaN(s)&&s>=0&&(r===1?e.style.bottom=parseInt(s,10)+""+"px":e.style.top=parseInt(s,10)+""+"px"),e}function createWidget(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d,v;if(document.getElementById(e)){try{console.log(e+" already exists.")}catch(m){}return!1}d=document.getElementById(t);if(!d){try{console.log(t+" does not exist.")}catch(g){}return!1}return c||(c="px"),v=document.createElement("div"),v.setAttribute("id",e),d.appendChild(v),n&&v.appendChild(n),f&&(v.className=f),h===0?v.style.display="none":v.style.display="block",parseInt(a,10)>0&&(v.style.height=parseInt(a,10)+""+c),parseInt(u,10)>0&&(v.style.width=parseInt(u,10)+""+c),v.style.position="absolute",v.widgetType=p,setWidgetPos(v,d,r,i,s,o,l)}function sendMsg(e,t,n){var r,i,s;if(sendMsg_active===!0)return sendMsg_list.push([e,t,n]),!0;sendMsg_active=!0,i=!1,s="index.php";if(window.XMLHttpRequest)i=new XMLHttpRequest;else if(window.ActiveXObject&&ActiveXObject)try{i=new ActiveXObject("Msxml2.XMLHTTP")}catch(o){try{i=new ActiveXObject("Microsoft.XMLHTTP")}catch(u){}}if(!i)return alert("Sorry, but oneye only works with AJAX capable browsers!"),!1;t!=="ping"&&(r=notifyLoadingRequest()),i.onreadystatechange=function(){var e,t,n;if(i.readyState===4){try{n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(i.responseText)}catch(s){t=new DOMParser,t.async="false",n=t.parseFromString(i.responseText,"text/xml")}i.responseText!=="<eyeMessage><action><task>pong</task></action></eyeMessage>"&&(clearTimeout(r),localEngine(n)),sendMsg_active=!1;for(e in sendMsg_list)if(sendMsg_list.hasOwnProperty(e)){sendMsg.apply(this,sendMsg_list[e]),delete sendMsg_list[e];return}}},i.open("POST",s+"?checknum="+e+"&msg="+t,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),i.send("params="+encodeURIComponent(n))}function localEngine(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I;notifyEndOfLoadingRequest();if(e.hasChildNodes()){t=e.getElementsByTagName("action"),t||(t=e.firstChild.childNodes),S=t.length;for(a=0;a<S;a+=1)try{O=getNodeValue(t[a].getElementsByTagName("task")[0]);if(O==="createWidget"){C=t[a].getElementsByTagName("position")[0],F=getNodeValue(C.getElementsByTagName("x")[0]),I=getNodeValue(C.getElementsByTagName("y")[0]),d=getNodeValue(C.getElementsByTagName("horiz")[0]),H=getNodeValue(C.getElementsByTagName("vert")[0]),x=getNodeValue(t[a].getElementsByTagName("name")[0]),s=getNodeValue(t[a].getElementsByTagName("checknum")[0]),h=getNodeValue(t[a].getElementsByTagName("father")[0]),j=getNodeValue(t[a].getElementsByTagName("widgetname")[0]),r=getNodeValue(t[a].getElementsByTagName("cent")[0]),N=getNodeValue(t[a].getElementsByTagName("params")[0]);try{evilEval(j+"_show("+N+",'"+x+"','"+h+"','"+F+"','"+I+"','"+d+"','"+H+"','"+s+"','"+r+"');")}catch(q){try{console.log("widget error: "+q)}catch(R){}}}else if(O==="messageBox")u=getNodeValue(t[a].getElementsByTagName("content")[0]),u=tinyMCE.entityDecode(u),_=parseInt(getNodeValue(t[a].getElementsByTagName("type")[0]),10),!_||_===1?eyeMessageBoxShow(u):_===2&&alert(u);else if(O==="setValue")u=getNodeValue(t[a].getElementsByTagName("content")[0]),B=getNodeValue(t[a].getElementsByTagName("widget")[0]),document.getElementById(B)&&(document.getElementById(B).value=u);else if(O==="setValueB64")u=getNodeValue(t[a].getElementsByTagName("content")[0]),B=getNodeValue(t[a].getElementsByTagName("widget")[0]),document.getElementById(B)&&(document.getElementById(B).value=Base64.decode(u));else if(O==="concatValue")u=getNodeValue(t[a].getElementsByTagName("content")[0]),B=getNodeValue(t[a].getElementsByTagName("widget")[0]),document.getElementById(B)&&(document.getElementById(B).value=document.getElementById(B).value+u);else if(O==="concatValueB64")u=getNodeValue(t[a].getElementsByTagName("content")[0]),B=getNodeValue(t[a].getElementsByTagName("widget")[0]),document.getElementById(B)&&(document.getElementById(B).value=document.getElementById(B).value+Base64.decode(u));else if(O==="concatDiv")u=getNodeValue(t[a].getElementsByTagName("content")[0]),B=getNodeValue(t[a].getElementsByTagName("widget")[0]),document.getElementById(B)&&(document.getElementById(B).innerHTML=document.getElementById(B).innerHTML+u);else if(O==="rawjs")m=getNodeValue(t[a].getElementsByTagName("js")[0]),m=m.replace(/\n/,""),m=m.replace(/\r/,""),evilEval(m);else if(O==="setDiv")u=getNodeValue(t[a].getElementsByTagName("content")[0]),x=getNodeValue(t[a].getElementsByTagName("name")[0]),document.getElementById(x).innerHTML=u;else if(O==="loadScript")D=getNodeValue(t[a].getElementsByTagName("url")[0]),dhtmlLoadScript(D);else if(O==="loadCSS")D=getNodeValue(t[a].getElementsByTagName("url")[0]),v=getNodeValue(t[a].getElementsByTagName("id")[0]),dhtmlLoadCSS(D,v);else if(O==="removeCSS")v=getNodeValue(t[a].getElementsByTagName("id")[0]),dhtmlRemoveCSS(v);else if(O==="removeWidget")x=getNodeValue(t[a].getElementsByTagName("name")[0]),removeWidget(x);else if(O==="createDiv")x=getNodeValue(t[a].getElementsByTagName("name")[0]),y=getNodeValue(t[a].getElementsByTagName("class")[0]),h=getNodeValue(t[a].getElementsByTagName("father")[0]),b=document.createElement("div"),b.setAttribute("id",x),b.className=y,f=document.getElementById(h),f.appendChild(b);else if(O==="setWallpaper")D=getNodeValue(t[a].getElementsByTagName("url")[0]),L=getNodeValue(t[a].getElementsByTagName("repeat")[0]),i=getNodeValue(t[a].getElementsByTagName("center")[0]),o=getNodeValue(t[a].getElementsByTagName("color")[0]),setWallpaper(D,L,i,o);else if(O==="updateCss")x=getNodeValue(t[a].getElementsByTagName("name")[0]),k=getNodeValue(t[a].getElementsByTagName("property")[0]),P=getNodeValue(t[a].getElementsByTagName("value")[0]),updateCss(x,k,P);else if(O==="makeDrag"){x=getNodeValue(t[a].getElementsByTagName("name")[0]),h=getNodeValue(t[a].getElementsByTagName("father")[0]);try{T=getNodeValue(t[a].getElementsByTagName("noIndex")[0]),makeDrag(x,h,"","","",T)}catch(U){makeDrag(x,h,"","","","")}}else if(O==="rawSendMessage")w=getNodeValue(t[a].getElementsByTagName("msg")[0]),t[a].getElementsByTagName("par")[0].firstChild?E=getNodeValue(t[a].getElementsByTagName("par")[0]):E="",g=getNodeValue(t[a].getElementsByTagName("checknum")[0]),sendMsg(g,w,E);else if(O==="addEvent"){x=getNodeValue(t[a].getElementsByTagName("name")[0]),c=getNodeValue(t[a].getElementsByTagName("event")[0]),p=getNodeValue(t[a].getElementsByTagName("func")[0]),n=getNodeValue(t[a].getElementsByTagName("args")[0]);if(!n||n==="0")n="";evilEval('document.getElementById("'+x+'").'+c+" = function ("+n+") {"+p+"};")}else O==="createLayer"?(x=getNodeValue(t[a].getElementsByTagName("name")[0]),y=getNodeValue(t[a].getElementsByTagName("class")[0]),h=getNodeValue(t[a].getElementsByTagName("father")[0]),createLayer(x,h,y)):O==="removeLayer"?(x=getNodeValue(t[a].getElementsByTagName("name")[0]),removeLayer(x)):O==="showLayer"?(x=getNodeValue(t[a].getElementsByTagName("name")[0]),showLayer(x)):O==="hideLayer"?(x=getNodeValue(t[a].getElementsByTagName("name")[0]),hideLayer(x)):O==="fadeOutLayer"?(x=getNodeValue(t[a].getElementsByTagName("name")[0]),M=getNodeValue(t[a].getElementsByTagName("time")[0]),A=getNodeValue(t[a].getElementsByTagName("startAlpha")[0]),l=getNodeValue(t[a].getElementsByTagName("endAlpha")[0]),fadeOutLayer(x,A,l,M)):O==="fadeInLayer"&&(x=getNodeValue(t[a].getElementsByTagName("name")[0]),M=getNodeValue(t[a].getElementsByTagName("time")[0]),A=getNodeValue(t[a].getElementsByTagName("startAlpha")[0]),l=getNodeValue(t[a].getElementsByTagName("endAlpha")[0]),fadeInLayer(x,A,l,M))}catch(z){try{console.log("Response error: "+z)}catch(W){}}}}var touchscreen,android,ios,windows_phone,OggVorbisAudioSupported,EventHandler,eyeKeyDown=0,IEversion=0,isEyeCursorActivated=!1,loadingRequests=0,messageBoxDirection=0,mouseX=0,mouseY=0,sendMsg_active=!1,sendMsg_list=[],TimeViewClock=2e3,zindex=100,zLayers=11;navigator.appVersion.indexOf("MSIE")!==-1&&(IEversion=parseFloat(navigator.appVersion.split("MSIE")[1])),touchscreen=typeof window.ontouchstart!="undefined",android=0,ios=0,windows_phone=0,navigator.userAgent.match(/Android/i)?android=1:navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)?ios=1:navigator.userAgent.match(/Windows Phone/i)&&(windows_phone=1),OggVorbisAudioSupported=function(){var e=document.createElement("audio");return typeof e.canPlayType=="function"&&e.canPlayType('audio/ogg; codecs="vorbis"')!==""?!0:!1}(),document.oncontextmenu=function(e){return IEversion||(e.preventDefault(),e.cancelBubble=!0),!1},document.onkeydown=function(e){e=new xEvent(e),e.which?eyeKeyDown=e.which:eyeKeyDown=e.keyCode},document.onkeyup=function(){eyeKeyDown=0},navigator.appVersion.indexOf("Mac")!==-1&&(document.onmousemove=function(e){IEversion&&IEversion<8?(mouseX=e.clientX+document.body.scrollLeft,mouseY=e.clientY+document.body.scrollTop):(mouseX=e.pageX,mouseY=e.pageY),typeof oCursor!="undefined"&&loadingRequests>0&&(oCursor.style.left=mouseX+10+"px",oCursor.style.top=mouseY-14+"px")}),tinyMCE.entityDecode=function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild?t.firstChild.nodeValue:e},EventHandler={List:{},LastEvent:0,HandleEvent:function(e){var t,n,r,i;e=new xEvent(e),EventHandler.LastEvent=e,r=0;for(t in EventHandler.List[e.type])if(EventHandler.List[e.type].hasOwnProperty(t)&&t!==e.target.id&&EventHandler.List[e.type][t]){if(EventHandler.List[e.type][t].option){i=e.target.parentNode;while(!r&&i)t===i.id?r=1:i=i.parentNode}if(!r)for(n in EventHandler.List[e.type][t].friends)EventHandler.List[e.type][t].friends[n]===e.target.id&&(r=1);EventHandler.List[e.type][t]["function"]&&(r=EventHandler.List[e.type][t]["function"](e,r)),r||evilEval(EventHandler.List[e.type][t].code),r=0}},Add:function(e,t,n,r,i){typeof EventHandler.List[e]!="object"&&(EventHandler.List[e]={},xAddEventListener(document,e,EventHandler.HandleEvent,!1)),typeof EventHandler.List[e][t]!="object"&&(EventHandler.List[e][t]={},EventHandler.List[e][t].friends=[]),EventHandler.List[e][t].code=n,typeof r!="undefined"&&(EventHandler.List[e][t].option=r),typeof i!="undefined"&&(EventHandler.List[e][t]["function"]=i)},AddFriend:function(e,t,n){EventHandler.List[e]&&EventHandler.List[e][t]&&EventHandler.List[e][t].friends.push(n)},Remove:function(e,t){EventHandler.List[e]&&EventHandler.List[e][t]&&(xRemoveEventListener(document,e,EventHandler.HandleEvent,!1),EventHandler.List[e][t]=0)},RemoveFriend:function(e,t,n){var r;for(r=0;r<EventHandler.List[e][t].friends.length;r+=1)if(EventHandler.List[e][t].friends[r]===n){EventHandler.List[e][t].friends[r]=0;return}}};