CodePress={scrolling:!1,autocomplete:!0,initialize:function(){if(typeof editor=="undefined"&&!arguments[0])return;chars="|32|46|62|",cc="â€‰",editor=document.getElementsByTagName("body")[0],document.designMode="on",document.addEventListener("keyup",this.keyHandler,!0),window.addEventListener("scroll",function(){CodePress.scrolling||CodePress.syntaxHighlight("scroll")},!1),completeChars=this.getCompleteChars()},keyHandler:function(e){keyCode=e.keyCode,charCode=e.charCode,(e.ctrlKey||e.metaKey)&&e.shiftKey&&charCode!=90?CodePress.shortcuts(charCode?charCode:keyCode):completeChars.indexOf("|"+String.fromCharCode(charCode)+"|")!=-1&&CodePress.autocomplete?CodePress.complete(String.fromCharCode(charCode)):chars.indexOf("|"+charCode+"|")!=-1||keyCode==13?CodePress.syntaxHighlight("generic"):keyCode==9||e.tabKey?CodePress.snippets(e):keyCode==46||keyCode==8?CodePress.actions.history[CodePress.actions.next()]=editor.innerHTML:(charCode==122||charCode==121||charCode==90)&&e.ctrlKey&&(charCode==121||e.shiftKey?CodePress.actions.redo():CodePress.actions.undo(),e.preventDefault())},findString:function(){var e=window.getSelection(),t=window.document.createRange(),n=window.document.getElementsByTagName("span")[0];t.selectNode(n),e.removeAllRanges(),e.addRange(t),n.parentNode.removeChild(n)},split:function(e,t){return t=="scroll"?(this.scrolling=!0,e):(this.scrolling=!1,mid=e.indexOf("<SPAN>"),mid-2e3<0?(ini=0,end=4e3):mid+2e3>e.length?(ini=e.length-4e3,end=e.length):(ini=mid-2e3,end=mid+2e3),e=e.substring(ini,end),e)},syntaxHighlight:function(e){var t;e!="init"&&(t=document.createElement("span"),window.getSelection().getRangeAt(0).insertNode(t)),o=editor.innerHTML,o=o.replace(/<(?!span|\/span|br).*?>/gi,""),x=z=this.split(o,e),x=x.replace(/\t/g,"        "),arguments[1]&&arguments[2]&&(x=x.replace(arguments[1],arguments[2]));for(i=0;i<Language.syntax.length;i++)x=x.replace(Language.syntax[i].input,Language.syntax[i].output);editor.innerHTML=this.actions.history[this.actions.next()]=e=="scroll"?x:o.split(z).join(x),e!="init"&&this.findString()},getLastWord:function(){var e=CodePress.getRangeAndCaret();return words=e[0].substring(e[1]-40,e[1]),words=words.replace(/[\s\n\r\);\W]/g,"\n").split("\n"),words[words.length-1].replace(/[\W]/gi,"").toLowerCase()},snippets:function(e){var t,n,r,i=Language.snippets,s=this.getLastWord();for(t=0;t<i.length;t++)i[t].input==s&&(n=i[t].output.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),n.indexOf("$0")<0?n+=cc:n=n.replace(/\$0/,cc),n=n.replace(/\n/g,"<br>"),r=RegExp(s+cc,"gi"),e.preventDefault(),this.syntaxHighlight("snippets",r,n))},readOnly:function(){document.designMode=arguments[0]?"off":"on"},complete:function(e){var t,n,r,i;window.getSelection().getRangeAt(0).deleteContents(),t=Language.complete;for(n=0;n<t.length;n++)t[n].input==e&&(r=RegExp("\\"+e+cc),i=t[n].output.replace(/\$0/g,cc),parent.setTimeout(function(){CodePress.syntaxHighlight("complete",r,i)},0))},getCompleteChars:function(){var e,t="";for(e=0;e<Language.complete.length;e++)t+="|"+Language.complete[e].input;return t+"|"},shortcuts:function(){var e,t=arguments[0];t==13?t="[enter]":t==32?t="[space]":t="["+String.fromCharCode(charCode).toLowerCase()+"]";for(e=0;e<Language.shortcuts.length;e++)Language.shortcuts[e].input==t&&this.insertCode(Language.shortcuts[e].output,!1)},getRangeAndCaret:function(){var e=window.getSelection().getRangeAt(0),t=e.cloneRange(),n=e.endContainer,r=e.endOffset;return t.selectNode(n),[t+"",r]},insertCode:function(e,t){var n=window.getSelection().getRangeAt(0),r=window.document.createTextNode(e),i=window.getSelection(),s=n.cloneRange();i.removeAllRanges(),n.deleteContents(),n.insertNode(r),s.selectNode(r),s.collapse(t),i.removeAllRanges(),i.addRange(s)},getCode:function(){var e=editor.innerHTML;return e=e.replace(/<br>/g,"\n"),e=e.replace(/\u2009/g,""),e=e.replace(/<.*?>/g,""),e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=e.replace(/&amp;/gi,"&"),e},setCode:function(){var e=arguments[0];e=e.replace(/\u2009/gi,""),e=e.replace(/&/gi,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),editor.innerHTML=e},actions:{pos:-1,history:[],undo:function(){editor.innerHTML.indexOf(cc)==-1&&(window.getSelection().getRangeAt(0).insertNode(document.createTextNode(cc)),this.history[this.pos]=editor.innerHTML),this.pos--,typeof this.history[this.pos]=="undefined"&&this.pos++,editor.innerHTML=this.history[this.pos],CodePress.findString()},redo:function(){this.pos++,typeof this.history[this.pos]=="undefined"&&this.pos--,editor.innerHTML=this.history[this.pos],CodePress.findString()},next:function(){return this.pos>20&&(this.history[this.pos-21]=undefined),++this.pos}}},Language={},window.addEventListener("load",function(){CodePress.initialize("new")},!0);