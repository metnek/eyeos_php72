(function(e){var t,n=e.DOM,r=e.dom.Event,i=e.extend,s=e.each,o=e.util.Cookie,u=e.explode;e.ThemeManager.requireLangPack("advanced"),e.create("tinymce.themes.AdvancedTheme",{sizes:[8,10,12,14,18,24,36],controls:{bold:["bold_desc","Bold"],italic:["italic_desc","Italic"],underline:["underline_desc","Underline"],strikethrough:["striketrough_desc","Strikethrough"],justifyleft:["justifyleft_desc","JustifyLeft"],justifycenter:["justifycenter_desc","JustifyCenter"],justifyright:["justifyright_desc","JustifyRight"],justifyfull:["justifyfull_desc","JustifyFull"],bullist:["bullist_desc","InsertUnorderedList"],numlist:["numlist_desc","InsertOrderedList"],outdent:["outdent_desc","Outdent"],indent:["indent_desc","Indent"],cut:["cut_desc","Cut"],copy:["copy_desc","Copy"],paste:["paste_desc","Paste"],undo:["undo_desc","Undo"],redo:["redo_desc","Redo"],link:["link_desc","mceLink"],unlink:["unlink_desc","unlink"],image:["image_desc","mceImage"],cleanup:["cleanup_desc","mceCleanup"],help:["help_desc","mceHelp"],code:["code_desc","mceCodeEditor"],hr:["hr_desc","InsertHorizontalRule"],removeformat:["removeformat_desc","RemoveFormat"],sub:["sub_desc","subscript"],sup:["sup_desc","superscript"],forecolor:["forecolor_desc","ForeColor"],forecolorpicker:["forecolor_desc","mceForeColor"],backcolor:["backcolor_desc","HiliteColor"],backcolorpicker:["backcolor_desc","mceBackColor"],charmap:["charmap_desc","mceCharMap"],visualaid:["visualaid_desc","mceToggleVisualAid"],anchor:["anchor_desc","mceInsertAnchor"],newdocument:["newdocument_desc","mceNewDocument"],blockquote:["blockquote_desc","mceBlockQuote"]},stateControls:["bold","italic","underline","strikethrough","bullist","numlist","justifyleft","justifycenter","justifyright","justifyfull","sub","sup","blockquote"],init:function(t,r){var o,u,a,f=this;f.editor=t,f.url=r,f.onResolveName=new e.util.Dispatcher(this),t.forcedHighContrastMode=t.settings.detect_highcontrast&&f._isHighContrast(),t.settings.skin=t.forcedHighContrastMode?"highcontrast":t.settings.skin,f.settings=o=i({theme_advanced_path:!0,theme_advanced_toolbar_location:"bottom",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect",theme_advanced_buttons2:"bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code",theme_advanced_buttons3:"hr,removeformat,visualaid,|,sub,sup,|,charmap",theme_advanced_blockformats:"p,address,pre,h1,h2,h3,h4,h5,h6",theme_advanced_toolbar_align:"center",theme_advanced_fonts:"Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",theme_advanced_more_colors:1,theme_advanced_row_height:23,theme_advanced_resize_horizontal:1,theme_advanced_resizing_use_cookie:1,theme_advanced_font_sizes:"1,2,3,4,5,6,7",theme_advanced_font_selector:"span",theme_advanced_show_current_color:0,readonly:t.settings.readonly},t.settings),o.font_size_style_values||(o.font_size_style_values="8pt,10pt,12pt,14pt,18pt,24pt,36pt"),e.is(o.theme_advanced_font_sizes,"string")&&(o.font_size_style_values=e.explode(o.font_size_style_values),o.font_size_classes=e.explode(o.font_size_classes||""),a={},t.settings.theme_advanced_font_sizes=o.theme_advanced_font_sizes,s(t.getParam("theme_advanced_font_sizes","","hash"),function(e,t){var n;t==e&&e>=1&&e<=7&&(t=e+" ("+f.sizes[e-1]+"pt)",n=o.font_size_classes[e-1],e=o.font_size_style_values[e-1]||f.sizes[e-1]+"pt"),/^\s*\./.test(e)&&(n=e.replace(/\./g,"")),a[t]=n?{"class":n}:{fontSize:e}}),o.theme_advanced_font_sizes=a),(u=o.theme_advanced_path_location)&&u!="none"&&(o.theme_advanced_statusbar_location=o.theme_advanced_path_location),o.theme_advanced_statusbar_location=="none"&&(o.theme_advanced_statusbar_location=0),t.settings.content_css!==!1&&t.contentCSS.push(t.baseURI.toAbsolute(r+"/skins/"+t.settings.skin+"/content.css")),t.onInit.add(function(){t.settings.readonly||(t.onNodeChange.add(f._nodeChanged,f),t.onKeyUp.add(f._updateUndoStatus,f),t.onMouseUp.add(f._updateUndoStatus,f),t.dom.bind(t.dom.getRoot(),"dragend",function(){f._updateUndoStatus(t)}))}),t.onSetProgressState.add(function(e,t,r){var i,s,o=e.id;t?f.progressTimer=setTimeout(function(){i=e.getContainer(),i=i.insertBefore(n.create("DIV",{style:"position:relative"}),i.firstChild),s=n.get(e.id+"_tbl"),n.add(i,"div",{id:o+"_blocker","class":"mceBlocker",style:{width:s.clientWidth+2,height:s.clientHeight+2}}),n.add(i,"div",{id:o+"_progress","class":"mceProgress",style:{left:s.clientWidth/2,top:s.clientHeight/2}})},r||0):(n.remove(o+"_blocker"),n.remove(o+"_progress"),clearTimeout(f.progressTimer))}),n.loadCSS(o.editor_css?t.documentBaseURI.toAbsolute(o.editor_css):r+"/skins/"+t.settings.skin+"/ui.css"),o.skin_variant&&n.loadCSS(r+"/skins/"+t.settings.skin+"/ui_"+o.skin_variant+".css")},_isHighContrast:function(){var e=n.add(n.getRoot(),"div",{style:"background-color: rgb(171,239,86);"}),t=(n.getStyle(e,"background-color",!0)+"").toLowerCase().replace(/ /g,"");return n.remove(e),t!="rgb(171,239,86)"&&t!="#abef56"},createControl:function(e,t){var n,r;if(r=t.createControl(e))return r;switch(e){case"styleselect":return this._createStyleSelect();case"formatselect":return this._createBlockFormats();case"fontselect":return this._createFontSelect();case"fontsizeselect":return this._createFontSizeSelect();case"forecolor":return this._createForeColorMenu();case"backcolor":return this._createBackColorMenu();case"zoomselect":return this._createZoomSelect()}if(n=this.controls[e])return t.createButton(e,{title:"advanced."+n[0],cmd:n[1],ui:n[2],value:n[3]})},execCommand:function(e,t,n){var r=this["_"+e];return r?(r.call(this,t,n),!0):!1},_importClasses:function(){var e=this.editor,t=e.controlManager.get("styleselect");t.getLength()==0&&s(e.dom.getClasses(),function(n,r){var i="style_"+r;e.formatter.register(i,{inline:"span",attributes:{"class":n["class"]},selector:"*"}),t.add(n["class"],i)})},_createStyleSelect:function(){var e=this,t=e.editor,n=t.controlManager,i=n.createListBox("styleselect",{title:"advanced.style_select",onselect:function(e){var n,r=[];return s(i.items,function(e){r.push(e.value)}),t.focus(),t.undoManager.add(),n=t.formatter.matchAll(r),!e||n[0]==e?n[0]&&t.formatter.remove(n[0]):t.formatter.apply(e),t.undoManager.add(),t.nodeChanged(),!1}});return t.onInit.add(function(){var n=0,r=t.getParam("style_formats");r?s(r,function(e){var r,o=0;s(e,function(){o++}),o>1?(r=e.name=e.name||"style_"+n++,t.formatter.register(r,e),i.add(e.title,r)):i.add(e.title)}):s(t.getParam("theme_advanced_styles","","hash"),function(r,s){var o;r&&(o="style_"+n++,t.formatter.register(o,{inline:"span",classes:r,selector:"*"}),i.add(e.editor.translate(s),o))})}),i.getLength()==0&&i.onPostRender.add(function(t,n){i.NativeListBox?r.add(n.id,"focus",e._importClasses,e):(r.add(n.id+"_text","focus",e._importClasses,e),r.add(n.id+"_text","mousedown",e._importClasses,e),r.add(n.id+"_open","focus",e._importClasses,e),r.add(n.id+"_open","mousedown",e._importClasses,e))}),i},_createFontSelect:function(){var e=this,t=e.editor,n=t.controlManager.createListBox("fontselect",{title:"advanced.fontdefault",onselect:function(e){var r=n.items[n.selectedIndex];if(!e&&r){t.execCommand("FontName",!1,r.value);return}return t.execCommand("FontName",!1,e),n.select(function(t){return e==t}),r&&r.value==e&&n.select(null),!1}});return n&&s(t.getParam("theme_advanced_fonts",e.settings.theme_advanced_fonts,"hash"),function(e,r){n.add(t.translate(r),e,{style:e.indexOf("dings")==-1?"font-family:"+e:""})}),n},_createFontSizeSelect:function(){var e=this,t=e.editor,n=0,r=[],i=t.controlManager.createListBox("fontsizeselect",{title:"advanced.font_size",onselect:function(e){var n=i.items[i.selectedIndex];if(!e&&n){n=n.value,n["class"]?(t.formatter.toggle("fontsize_class",{value:n["class"]}),t.undoManager.add(),t.nodeChanged()):t.execCommand("FontSize",!1,n.fontSize);return}return e["class"]?(t.focus(),t.undoManager.add(),t.formatter.toggle("fontsize_class",{value:e["class"]}),t.undoManager.add(),t.nodeChanged()):t.execCommand("FontSize",!1,e.fontSize),i.select(function(t){return e==t}),n&&(n.value.fontSize==e.fontSize||n.value["class"]&&n.value["class"]==e["class"])&&i.select(null),!1}});return i&&s(e.settings.theme_advanced_font_sizes,function(t,r){var s=t.fontSize;s>=1&&s<=7&&(s=e.sizes[parseInt(s)-1]+"pt"),i.add(r,t,{style:"font-size:"+s,"class":"mceFontSize"+n++ +(" "+(t["class"]||""))})}),i},_createBlockFormats:function(){var e={p:"advanced.paragraph",address:"advanced.address",pre:"advanced.pre",h1:"advanced.h1",h2:"advanced.h2",h3:"advanced.h3",h4:"advanced.h4",h5:"advanced.h5",h6:"advanced.h6",div:"advanced.div",blockquote:"advanced.blockquote",code:"advanced.code",dt:"advanced.dt",dd:"advanced.dd",samp:"advanced.samp"},t=this,n=t.editor.controlManager.createListBox("formatselect",{title:"advanced.block",onselect:function(e){return t.editor.execCommand("FormatBlock",!1,e),!1}});return n&&s(t.editor.getParam("theme_advanced_blockformats",t.settings.theme_advanced_blockformats,"hash"),function(r,i){n.add(t.editor.translate(i!=r?i:e[r]),r,{"class":"mce_formatPreview mce_"+r})}),n},_createZoomSelect:function(){var e=this,t=e.editor,n=t.controlManager.createListBox("zoomselect",{title:"zoom",cmd:"SelectZoom"});return n&&(n.add("50%","50",{style:"font-size:8px;"}),n.add("75%","75",{style:"font-size:9px;"}),n.add("100%","100",{style:"font-size:10px;"}),n.add("125%","125",{style:"font-size:11px;"}),n.add("150%","150",{style:"font-size:12px;"}),n.add("175%","175",{style:"font-size:13px;"}),n.add("200%","200",{style:"font-size:14px;"})),n},_createForeColorMenu:function(){var e,t,n=this,r=n.settings,i={};r.theme_advanced_more_colors&&(i.more_colors_func=function(){n._mceColorPicker(0,{color:e.value,func:function(t){e.setColor(t)}})});if(t=r.theme_advanced_text_colors)i.colors=t;return r.theme_advanced_default_foreground_color&&(i.default_color=r.theme_advanced_default_foreground_color),i.title="advanced.forecolor_desc",i.cmd="ForeColor",i.scope=this,e=n.editor.controlManager.createColorSplitButton("forecolor",i),e},_createBackColorMenu:function(){var e,t,n=this,r=n.settings,i={};r.theme_advanced_more_colors&&(i.more_colors_func=function(){n._mceColorPicker(0,{color:e.value,func:function(t){e.setColor(t)}})});if(t=r.theme_advanced_background_colors)i.colors=t;return r.theme_advanced_default_background_color&&(i.default_color=r.theme_advanced_default_background_color),i.title="advanced.backcolor_desc",i.cmd="HiliteColor",i.scope=this,e=n.editor.controlManager.createColorSplitButton("backcolor",i),e},renderUI:function(t){var i,o,u,a,f,l,c=this,h=c.editor,p=c.settings;h.settings&&(h.settings.aria_label=p.aria_label+h.getLang("advanced.help_shortcut")),i=f=n.create("span",{role:"application","aria-labelledby":h.id+"_voice",id:h.id+"_parent","class":"mceEditor "+h.settings.skin+"Skin"+(p.skin_variant?" "+h.settings.skin+"Skin"+c._ufirst(p.skin_variant):"")}),n.add(i,"span",{"class":"mceVoiceLabel",style:"display:none;",id:h.id+"_voice"},p.aria_label),n.boxModel||(i=n.add(i,"div",{"class":"mceOldBoxModel"})),i=a=n.add(i,"table",{role:"presentation",id:h.id+"_tbl","class":"mceLayout",cellSpacing:0,cellPadding:0}),i=u=n.add(i,"tbody");switch((p.theme_advanced_layout_manager||"").toLowerCase()){case"rowlayout":o=c._rowLayout(p,u,t);break;case"customlayout":o=h.execCallback("theme_advanced_custom_layout",p,u,t,f);break;default:o=c._simpleLayout(p,u,t,f)}return i=t.targetNode,l=a.rows,n.addClass(l[0],"mceFirst"),n.addClass(l[l.length-1],"mceLast"),s(n.select("tr",u),function(e){n.addClass(e.firstChild,"mceFirst"),n.addClass(e.childNodes[e.childNodes.length-1],"mceLast")}),n.get(p.theme_advanced_toolbar_container)?n.get(p.theme_advanced_toolbar_container).appendChild(f):n.insertAfter(f,i),r.add(h.id+"_path_row","click",function(e){e=e.target;if(e.nodeName=="A")return c._sel(e.className.replace(/^.*mcePath_([0-9]+).*$/,"$1")),r.cancel(e)}),h.getParam("accessibility_focus")||r.add(n.add(f,"a",{href:"#"},"<!-- IE -->"),"focus",function(){tinyMCE.get(h.id).focus()}),p.theme_advanced_toolbar_location=="external"&&(t.deltaHeight=0),c.deltaHeight=t.deltaHeight,t.targetNode=null,h.onKeyDown.add(function(t,i){var s=121,o=122;if(i.altKey){if(i.keyCode===s)return e.isWebKit&&window.focus(),c.toolbarGroup.focus(),r.cancel(i);if(i.keyCode===o)return n.get(t.id+"_path_row").focus(),r.cancel(i)}}),h.addShortcut("alt+0","","mceShortcuts",c),{iframeContainer:o,editorContainer:h.id+"_parent",sizeContainer:a,deltaHeight:t.deltaHeight}},getInfo:function(){return{longname:"Advanced theme",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",version:e.majorVersion+"."+e.minorVersion}},resizeBy:function(e,t){var r=n.get(this.editor.id+"_ifr");this.resizeTo(r.clientWidth+e,r.clientHeight+t)},resizeTo:function(e,t,r){var i=this.editor,s=this.settings,u=n.get(i.id+"_tbl"),a=n.get(i.id+"_ifr");e=Math.max(s.theme_advanced_resizing_min_width||100,e),t=Math.max(s.theme_advanced_resizing_min_height||100,t),e=Math.min(s.theme_advanced_resizing_max_width||65535,e),t=Math.min(s.theme_advanced_resizing_max_height||65535,t),n.setStyle(u,"height",""),n.setStyle(a,"height",t),s.theme_advanced_resize_horizontal&&(n.setStyle(u,"width",""),n.setStyle(a,"width",e),e<u.clientWidth&&(e=u.clientWidth,n.setStyle(a,"width",u.clientWidth))),r&&s.theme_advanced_resizing_use_cookie&&o.setHash("TinyMCE_"+i.id+"_size",{cw:e,ch:t})},destroy:function(){var e=this.editor.id;r.clear(e+"_resize"),r.clear(e+"_path_row"),r.clear(e+"_external_close")},_simpleLayout:function(e,i,s,o){var u,a,f,l,c=this,h=c.editor,p=e.theme_advanced_toolbar_location,d=e.theme_advanced_statusbar_location;return e.readonly?(u=n.add(i,"tr"),u=a=n.add(u,"td",{"class":"mceIframeContainer"}),a):(p=="top"&&c._addToolbars(i,s),p=="external"&&(u=l=n.create("div",{style:"position:relative"}),u=n.add(u,"div",{id:h.id+"_external","class":"mceExternalToolbar"}),n.add(u,"a",{id:h.id+"_external_close",href:"javascript:;","class":"mceExternalClose"}),u=n.add(u,"table",{id:h.id+"_tblext",cellSpacing:0,cellPadding:0}),f=n.add(u,"tbody"),o.firstChild.className=="mceOldBoxModel"?o.firstChild.appendChild(l):o.insertBefore(l,o.firstChild),c._addToolbars(f,s),h.onMouseUp.add(function(){var e,i=n.get(h.id+"_external");n.show(i),n.hide(t),e=r.add(h.id+"_external_close","click",function(){n.hide(h.id+"_external"),r.remove(h.id+"_external_close","click",e)}),n.show(i),n.setStyle(i,"top",0-n.getRect(h.id+"_tblext").h-1),n.hide(i),n.show(i),i.style.filter="",t=h.id+"_external",i=null})),d=="top"&&c._addStatusBar(i,s),e.theme_advanced_toolbar_container||(u=n.add(i,"tr"),u=a=n.add(u,"td",{"class":"mceIframeContainer"})),p=="bottom"&&c._addToolbars(i,s),d=="bottom"&&c._addStatusBar(i,s),a)},_rowLayout:function(e,t,r){var i,o,a,f,l=this,c=l.editor,h=c.controlManager,p=e.theme_advanced_containers_default_class||"",d=e.theme_advanced_containers_default_align||"center";return s(u(e.theme_advanced_containers||""),function(s,u){var c=e["theme_advanced_container_"+s]||"";switch(s.toLowerCase()){case"mceeditor":i=n.add(t,"tr"),i=o=n.add(i,"td",{"class":"mceIframeContainer"});break;case"mceelementpath":l._addStatusBar(t,r);break;default:f=(e["theme_advanced_container_"+s+"_align"]||d).toLowerCase(),f="mce"+l._ufirst(f),i=n.add(n.add(t,"tr"),"td",{"class":"mceToolbar "+(e["theme_advanced_container_"+s+"_class"]||p)+" "+f||d}),a=h.createToolbar("toolbar"+u),l._addControls(c,a),n.setHTML(i,a.renderHTML()),r.deltaHeight-=e.theme_advanced_row_height}}),o},_addControls:function(e,t){var n,r=this,i=r.settings,o=r.editor.controlManager;i.theme_advanced_disable&&!r._disabled?(n={},s(u(i.theme_advanced_disable),function(e){n[e]=1}),r._disabled=n):n=r._disabled,s(u(e),function(e){var i;if(n&&n[e])return;if(e=="tablecontrols"){s(["table","|","row_props","cell_props","|","row_before","row_after","delete_row","|","col_before","col_after","delete_col","|","split_cells","merge_cells"],function(e){e=r.createControl(e,o),e&&t.add(e)});return}i=r.createControl(e,o),i&&t.add(i)})},_addToolbars:function(e,t){var r,i,s,o,u,a=this,f=a.editor,l=a.settings,c=f.controlManager,h=[],p=c.createToolbarGroup("toolbargroup",{name:f.getLang("advanced.toolbar"),tab_focus_toolbar:f.getParam("theme_advanced_tab_focus_toolbar")});a.toolbarGroup=p,u=l.theme_advanced_toolbar_align.toLowerCase(),u="mce"+a._ufirst(u),o=n.add(n.add(e,"tr",{role:"presentation"}),"td",{"class":"mceToolbar "+u,role:"presentation"});for(r=1;s=l["theme_advanced_buttons"+r];r++)i=c.createToolbar("toolbar"+r,{"class":"mceToolbarRow"+r}),l["theme_advanced_buttons"+r+"_add"]&&(s+=","+l["theme_advanced_buttons"+r+"_add"]),l["theme_advanced_buttons"+r+"_add_before"]&&(s=l["theme_advanced_buttons"+r+"_add_before"]+","+s),a._addControls(s,i),p.add(i),t.deltaHeight-=l.theme_advanced_row_height;h.push(p.renderHTML()),h.push(n.createHTML("a",{href:"#",accesskey:"z",title:f.getLang("advanced.toolbar_focus"),onfocus:"tinyMCE.getInstanceById('"+f.id+"').focus();"},"<!-- IE -->")),n.setHTML(o,h.join(""))},_addStatusBar:function(e,t){var i,s=this,u=s.editor,a=s.settings,f=n.add(e,"tr");f=i=n.add(f,"td",{"class":"mceStatusbar"}),f=n.add(f,"div",{id:u.id+"_path_row",role:"group","aria-labelledby":u.id+"_path_voice"}),a.theme_advanced_path?(n.add(f,"span",{id:u.id+"_path_voice"},u.translate("advanced.path")),n.add(f,"span",{},": ")):n.add(f,"span",{},"&#160;"),a.theme_advanced_resizing&&(n.add(i,"a",{id:u.id+"_resize",href:"javascript:;",onclick:"return false;","class":"mceResize",tabIndex:"-1"}),a.theme_advanced_resizing_use_cookie&&u.onPostRender.add(function(){var e=o.getHash("TinyMCE_"+u.id+"_size"),t=n.get(u.id+"_tbl");if(!e)return;s.resizeTo(e.cw,e.ch)}),u.onPostRender.add(function(){r.add(u.id+"_resize","click",function(e){e.preventDefault()}),r.add(u.id+"_resize","mousedown",function(e){function m(e){e.preventDefault(),p=c+(e.screenX-f),d=h+(e.screenY-l),s.resizeTo(p,d)}function g(e){r.remove(n.doc,"mousemove",t),r.remove(u.getDoc(),"mousemove",i),r.remove(n.doc,"mouseup",o),r.remove(u.getDoc(),"mouseup",a),p=c+(e.screenX-f),d=h+(e.screenY-l),s.resizeTo(p,d,!0)}var t,i,o,a,f,l,c,h,p,d,v;e.preventDefault(),f=e.screenX,l=e.screenY,v=n.get(s.editor.id+"_ifr"),c=p=v.clientWidth,h=d=v.clientHeight,t=r.add(n.doc,"mousemove",m),i=r.add(u.getDoc(),"mousemove",m),o=r.add(n.doc,"mouseup",g),a=r.add(u.getDoc(),"mouseup",g)})})),t.deltaHeight-=21,f=e=null},_updateUndoStatus:function(e){var t=e.controlManager,n=e.undoManager;t.setDisabled("undo",!n.hasUndo()&&!n.typing),t.setDisabled("redo",!n.hasRedo())},_nodeChanged:function(t,r,i,o,u){function E(e){var t,n=u.parents,r=e;typeof e=="string"&&(r=function(t){return t.nodeName==e});for(t=0;t<n.length;t++)if(r(n[t]))return n[t]}var a,f,l,c,h,p,d,v,m,g,y=this,b=0,w=y.settings;e.each(y.stateControls,function(e){r.setActive(e,t.queryCommandState(y.controls[e][1]))}),r.setActive("visualaid",t.hasVisual),y._updateUndoStatus(t),r.setDisabled("outdent",!t.queryCommandState("Outdent")),a=E("A");if(l=r.get("link"))if(!a||!a.name)l.setDisabled(!a&&o),l.setActive(!!a);if(l=r.get("unlink"))l.setDisabled(!a&&o),l.setActive(!!a&&!a.name);(l=r.get("anchor"))&&l.setActive(!o&&!!a&&a.name),a=E("IMG"),(l=r.get("image"))&&l.setActive(!o&&!!a&&i.className.indexOf("mceItem")==-1);if(l=r.get("styleselect"))y._importClasses(),m=[],s(l.items,function(e){m.push(e.value)}),g=t.formatter.matchAll(m),l.select(g[0]);if(l=r.get("formatselect"))a=E(n.isBlock),a&&l.select(a.nodeName.toLowerCase());E(function(e){return e.nodeName==="SPAN"&&!c&&e.className&&(c=e.className),t.dom.is(e,w.theme_advanced_font_selector)&&(!h&&e.style.fontSize&&(h=e.style.fontSize),!p&&e.style.fontFamily&&(p=e.style.fontFamily.replace(/[\"\']+/g,"").replace(/^([^,]+).*/,"$1").toLowerCase()),!d&&e.style.color&&(d=e.style.color),!v&&e.style.backgroundColor&&(v=e.style.backgroundColor)),!1}),(l=r.get("fontselect"))&&l.select(function(e){return e.replace(/^([^,]+).*/,"$1").toLowerCase()==p});if(l=r.get("fontsizeselect"))w.theme_advanced_runtime_fontsize&&!h&&!c&&(h=t.dom.getStyle(i,"fontSize",!0)),l.select(function(e){if(e.fontSize&&e.fontSize===h)return!0;if(e["class"]&&e["class"]===c)return!0});if(w.theme_advanced_show_current_color){function S(e,t){if(l=r.get(e))t||(t=l.settings.default_color),t!==l.value&&l.displayColor(t)}S("forecolor",d),S("backcolor",v)}if(w.theme_advanced_show_current_color){function S(e,t){if(l=r.get(e))t||(t=l.settings.default_color),t!==l.value&&l.displayColor(t)}S("forecolor",d),S("backcolor",v)}w.theme_advanced_path&&w.theme_advanced_statusbar_location&&(a=n.get(t.id+"_path")||n.add(t.id+"_path_row","span",{id:t.id+"_path"}),y.statusKeyboardNavigation&&(y.statusKeyboardNavigation.destroy(),y.statusKeyboardNavigation=null),n.setHTML(a,""),E(function(t){var r,i=t.nodeName.toLowerCase(),s="";if(t.nodeType!=1||i==="br"||t.getAttribute("data-mce-bogus")||n.hasClass(t,"mceItemHidden")||n.hasClass(t,"mceItemRemoved"))return;e.isIE&&t.scopeName!=="HTML"&&(i=t.scopeName+":"+i),i=i.replace(/mce\:/g,"");switch(i){case"b":i="strong";break;case"i":i="em";break;case"img":if(f=n.getAttrib(t,"src"))s+="src: "+f+" ";break;case"a":if(f=n.getAttrib(t,"name"))s+="name: "+f+" ",i+="#"+f;if(f=n.getAttrib(t,"href"))s+="href: "+f+" ";break;case"font":if(f=n.getAttrib(t,"face"))s+="font: "+f+" ";if(f=n.getAttrib(t,"size"))s+="size: "+f+" ";if(f=n.getAttrib(t,"color"))s+="color: "+f+" ";break;case"span":if(f=n.getAttrib(t,"style"))s+="style: "+f+" "}if(f=n.getAttrib(t,"id"))s+="id: "+f+" ";if(f=t.className){f=f.replace(/\b\s*(webkit|mce|Apple-)\w+\s*\b/g,"");if(f){s+="class: "+f+" ";if(n.isBlock(t)||i=="img"||i=="span")i+="."+f}}i=i.replace(/(html:)/g,""),i={name:i,node:t,title:s},y.onResolveName.dispatch(y,i),s=i.title,i=i.name,r=n.create("a",{href:"javascript:;",role:"button",onmousedown:"return false;",title:s,"class":"mcePath_"+b++},i),a.hasChildNodes()?(a.insertBefore(n.create("span",{"aria-hidden":"true"}," » "),a.firstChild),a.insertBefore(r,a.firstChild)):a.appendChild(r)},t.getBody()),n.select("a",a).length>0&&(y.statusKeyboardNavigation=new e.ui.KeyboardNavigation({root:t.id+"_path_row",items:n.select("a",a),excludeFromTabOrder:!0,onCancel:function(){t.focus()}},n)))},_sel:function(e){this.editor.execCommand("mceSelectNodeDepth",!1,e)},_mceInsertAnchor:function(){var e=this.editor;e.windowManager.open({url:this.url+"/anchor.htm",width:320+parseInt(e.getLang("advanced.anchor_delta_width",0)),height:90+parseInt(e.getLang("advanced.anchor_delta_height",0)),inline:!0},{theme_url:this.url})},_mceCharMap:function(){var e=this.editor;e.windowManager.open({url:this.url+"/charmap.htm",width:550+parseInt(e.getLang("advanced.charmap_delta_width",0)),height:265+parseInt(e.getLang("advanced.charmap_delta_height",0)),inline:!0},{theme_url:this.url})},_mceHelp:function(){var e=this.editor;e.windowManager.open({url:this.url+"/about.htm",width:480,height:380,inline:!0},{theme_url:this.url})},_mceShortcuts:function(){var e=this.editor;e.windowManager.open({url:this.url+"/shortcuts.htm",width:480,height:380,inline:!0},{theme_url:this.url})},_mceColorPicker:function(e,t){var n=this.editor;t=t||{},n.windowManager.open({url:this.url+"/color_picker.htm",width:375+parseInt(n.getLang("advanced.colorpicker_delta_width",0)),height:250+parseInt(n.getLang("advanced.colorpicker_delta_height",0)),close_previous:!1,inline:!0},{input_color:t.color,func:t.func,theme_url:this.url})},_mceCodeEditor:function(){var e=this.editor;e.windowManager.open({url:this.url+"/source_editor.htm",width:parseInt(e.getParam("theme_advanced_source_editor_width",720)),height:parseInt(e.getParam("theme_advanced_source_editor_height",580)),inline:!0,resizable:!0,maximizable:!0},{theme_url:this.url})},_mceImage:function(){var e=this.editor;if(e.dom.getAttrib(e.selection.getNode(),"class").indexOf("mceItem")!=-1)return;e.windowManager.open({url:this.url+"/image.htm",width:355+parseInt(e.getLang("advanced.image_delta_width",0)),height:275+parseInt(e.getLang("advanced.image_delta_height",0)),inline:!0},{theme_url:this.url})},_mceLink:function(){var e=this.editor;e.windowManager.open({url:this.url+"/link.htm",width:310+parseInt(e.getLang("advanced.link_delta_width",0)),height:200+parseInt(e.getLang("advanced.link_delta_height",0)),inline:!0},{theme_url:this.url})},_mceNewDocument:function(){var e=this.editor;e.windowManager.confirm("advanced.newdocument",function(t){t&&(sendMsg(e.checknum,"New",""),e.execCommand("mceSetContent",!1,""))})},_mceForeColor:function(){var e=this;this._mceColorPicker(0,{color:e.fgColor,func:function(t){e.fgColor=t,e.editor.execCommand("ForeColor",!1,t)}})},_mceBackColor:function(){var e=this;this._mceColorPicker(0,{color:e.bgColor,func:function(t){e.bgColor=t,e.editor.execCommand("HiliteColor",!1,t)}})},_ufirst:function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}}),e.ThemeManager.add("advanced",e.themes.AdvancedTheme)})(tinymce);