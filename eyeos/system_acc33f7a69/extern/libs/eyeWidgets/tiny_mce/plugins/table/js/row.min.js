function init(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d;tinyMCEPopup.resizeToInnerSize(),document.getElementById("backgroundimagebrowsercontainer").innerHTML=getBrowserHTML("backgroundimagebrowser","backgroundimage","image","table"),document.getElementById("bgcolor_pickcontainer").innerHTML=getColorPickerHTML("bgcolor_pick","bgcolor"),e=tinyMCEPopup.editor,t=e.dom,n=t.getParent(e.selection.getStart(),"tr"),r=document.forms[0],i=t.parseStyle(t.getAttrib(n,"style")),s=n.parentNode.nodeName.toLowerCase(),o=t.getAttrib(n,"align"),u=t.getAttrib(n,"valign"),a=trimSize(getStyle(n,"height","height")),f=t.getAttrib(n,"class"),l=convertRGBToHex(getStyle(n,"bgcolor","backgroundColor")),c=getStyle(n,"background","backgroundImage").replace(RegExp("url\\(['\"]?([^'\"]*)['\"]?\\)","gi"),"$1"),h=t.getAttrib(n,"id"),p=t.getAttrib(n,"lang"),d=t.getAttrib(n,"dir"),selectByValue(r,"rowtype",s),t.select("td.mceSelected,th.mceSelected",n).length==0?(addClassesToList("class","table_row_styles"),TinyMCE_EditableSelects.init(),r.bgcolor.value=l,r.backgroundimage.value=c,r.height.value=a,r.id.value=h,r.lang.value=p,r.style.value=t.serializeStyle(i),selectByValue(r,"align",o),selectByValue(r,"valign",u),selectByValue(r,"class",f,!0,!0),selectByValue(r,"dir",d),isVisible("backgroundimagebrowser")&&(document.getElementById("backgroundimage").style.width="180px"),updateColor("bgcolor_pick","bgcolor")):tinyMCEPopup.dom.hide("action")}function updateAction(){var e,t,n,r,i=tinyMCEPopup.editor,s=i.dom,o=document.forms[0],u=getSelectValue(o,"action");if(!AutoValidator.validate(o))return tinyMCEPopup.alert(AutoValidator.getErrorMessages(o).join(". ")+"."),!1;tinyMCEPopup.restoreSelection(),e=s.getParent(i.selection.getStart(),"tr"),t=s.getParent(i.selection.getStart(),"table");if(s.select("td.mceSelected,th.mceSelected",e).length>0){tinymce.each(t.rows,function(e){var t;for(t=0;t<e.cells.length;t++)if(s.hasClass(e.cells[t],"mceSelected")){updateRow(e,!0);return}}),i.addVisual(),i.nodeChanged(),i.execCommand("mceEndUndoLevel"),tinyMCEPopup.close();return}switch(u){case"row":updateRow(e);break;case"all":n=t.getElementsByTagName("tr");for(r=0;r<n.length;r++)updateRow(n[r],!0);break;case"odd":case"even":n=t.getElementsByTagName("tr");for(r=0;r<n.length;r++)(r%2==0&&u=="odd"||r%2!=0&&u=="even")&&updateRow(n[r],!0,!0)}i.addVisual(),i.nodeChanged(),i.execCommand("mceEndUndoLevel"),tinyMCEPopup.close()}function updateRow(e,t,n){var r,i,s,o,u,a=tinyMCEPopup.editor,f=document.forms[0],l=a.dom,c=e.parentNode.nodeName.toLowerCase(),h=getSelectValue(f,"rowtype"),p=a.getDoc();t||l.setAttrib(e,"id",f.id.value),l.setAttrib(e,"align",getSelectValue(f,"align")),l.setAttrib(e,"vAlign",getSelectValue(f,"valign")),l.setAttrib(e,"lang",f.lang.value),l.setAttrib(e,"dir",getSelectValue(f,"dir")),l.setAttrib(e,"style",l.serializeStyle(l.parseStyle(f.style.value))),l.setAttrib(e,"class",getSelectValue(f,"class")),l.setAttrib(e,"background",""),l.setAttrib(e,"bgColor",""),l.setAttrib(e,"height",""),e.style.height=getCSSSize(f.height.value),e.style.backgroundColor=f.bgcolor.value,f.backgroundimage.value!=""?e.style.backgroundImage="url('"+f.backgroundimage.value+"')":e.style.backgroundImage="";if(c!=h&&!n){r=e.cloneNode(1),i=l.getParent(e,"table"),s=h,o=null;for(u=0;u<i.childNodes.length;u++)i.childNodes[u].nodeName.toLowerCase()==s&&(o=i.childNodes[u]);o==null&&(o=p.createElement(s),i.firstChild.nodeName=="CAPTION"?a.dom.insertAfter(o,i.firstChild):i.insertBefore(o,i.firstChild)),o.appendChild(r),e.parentNode.removeChild(e),e=r}l.setAttrib(e,"style",l.serializeStyle(l.parseStyle(e.style.cssText)))}function changedBackgroundImage(){var e=document.forms[0],t=tinyMCEPopup.editor.dom,n=t.parseStyle(e.style.value);n["background-image"]="url('"+e.backgroundimage.value+"')",e.style.value=t.serializeStyle(n)}function changedStyle(){var e=document.forms[0],t=tinyMCEPopup.editor.dom,n=t.parseStyle(e.style.value);n["background-image"]?e.backgroundimage.value=n["background-image"].replace(RegExp("url\\('?([^']*)'?\\)","gi"),"$1"):e.backgroundimage.value="",n.height&&(e.height.value=trimSize(n.height)),n["background-color"]&&(e.bgcolor.value=n["background-color"],updateColor("bgcolor_pick","bgcolor"))}function changedSize(){var e=document.forms[0],t=tinyMCEPopup.editor.dom,n=t.parseStyle(e.style.value),r=e.height.value;r!=""?n.height=getCSSSize(r):n.height="",e.style.value=t.serializeStyle(n)}function changedColor(){var e=document.forms[0],t=tinyMCEPopup.editor.dom,n=t.parseStyle(e.style.value);n["background-color"]=e.bgcolor.value,e.style.value=t.serializeStyle(n)}tinyMCEPopup.requireLangPack(),tinyMCEPopup.onInit.add(init);