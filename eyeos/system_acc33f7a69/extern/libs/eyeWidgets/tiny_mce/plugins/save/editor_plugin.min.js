(function(){tinymce.create("tinymce.plugins.Save",{init:function(e){var t=this;t.editor=e,e.addCommand("mceSave",t._save,t),e.addCommand("mceCancel",t._cancel,t),e.addButton("save",{title:"save.save_desc",cmd:"mceSave"}),e.addButton("cancel",{title:"save.cancel_desc",cmd:"mceCancel"}),e.onNodeChange.add(t._nodeChange,t),e.addShortcut("ctrl+s",e.getLang("save.save_desc"),"mceSave")},getInfo:function(){return{longname:"Save",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/save",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_nodeChange:function(e,t){var e=this.editor;e.getParam("save_enablewhendirty")&&(t.setDisabled("save",!e.isDirty()),t.setDisabled("cancel",!e.isDirty()))},_save:function(){var e,t=this.editor,n=tinymce.DOM.get(t.id).form||tinymce.DOM.getParent(t.id,"form");if(t.getParam("save_enablewhendirty")&&!t.isDirty())return;tinyMCE.triggerSave();if(e=t.getParam("save_onsavecallback")){t.execCallback("save_onsavecallback",t)&&(t.startContent=tinymce.trim(t.getContent({format:"raw"})),t.nodeChanged());return}n?(t.isNotDirty=!0,(n.onsubmit==null||n.onsubmit()!=0)&&n.submit(),t.nodeChanged()):t.windowManager.alert("Error: No form element found.")},_cancel:function(){var e,t=this.editor,n=tinymce.trim(t.startContent);if(e=t.getParam("save_oncancelcallback")){t.execCallback("save_oncancelcallback",t);return}t.setContent(n),t.undoManager.clear(),t.nodeChanged()}}),tinymce.PluginManager.add("save",tinymce.plugins.Save)})();