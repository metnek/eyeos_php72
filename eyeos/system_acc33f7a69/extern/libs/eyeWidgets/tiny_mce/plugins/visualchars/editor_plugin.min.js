(function(){tinymce.create("tinymce.plugins.VisualChars",{init:function(e){var t=this;t.editor=e,e.addCommand("mceVisualChars",t._toggleVisualChars,t),e.addButton("visualchars",{title:"visualchars.desc",cmd:"mceVisualChars"}),e.onBeforeGetContent.add(function(e,n){t.state&&n.format!="raw"&&!n.draft&&(t.state=!0,t._toggleVisualChars(!1))})},getInfo:function(){return{longname:"Visual characters",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/visualchars",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_toggleVisualChars:function(e){var t,n,r,i,s,o=this,u=o.editor,a=u.getDoc(),f=u.getBody(),l=u.selection;o.state=!o.state,u.controlManager.setActive("visualchars",o.state),e&&(s=l.getBookmark());if(o.state){t=[],tinymce.walk(f,function(e){e.nodeType==3&&e.nodeValue&&e.nodeValue.indexOf("Â ")!=-1&&t.push(e)},"childNodes");for(n=0;n<t.length;n++){r=t[n].nodeValue,r=r.replace(/(\u00a0)/g,'<span data-mce-bogus="1" class="mceItemHidden mceItemNbsp">$1</span>'),i=u.dom.create("div",null,r);while(node=i.lastChild)u.dom.insertAfter(node,t[n]);u.dom.remove(t[n])}}else{t=u.dom.select("span.mceItemNbsp",f);for(n=t.length-1;n>=0;n--)u.dom.remove(t[n],1)}l.moveToBookmark(s)}}),tinymce.PluginManager.add("visualchars",tinymce.plugins.VisualChars)})();